<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 2 Generalized Lotka-Volterra | A tour of the Generalized Lotka-Volterra Model</title>
  <meta name="description" content="Lectures for the ICTP-SAIFR/IFT-UNESP School on Community Ecology: from patterns to principles" />
  <meta name="generator" content="bookdown 0.16 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 2 Generalized Lotka-Volterra | A tour of the Generalized Lotka-Volterra Model" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Lectures for the ICTP-SAIFR/IFT-UNESP School on Community Ecology: from patterns to principles" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 2 Generalized Lotka-Volterra | A tour of the Generalized Lotka-Volterra Model" />
  
  <meta name="twitter:description" content="Lectures for the ICTP-SAIFR/IFT-UNESP School on Community Ecology: from patterns to principles" />
  

<meta name="author" content="Stefano Allesina" />


<meta name="date" content="2019-12-19" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="multi.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Lectures on Lotka-Volterra</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#prerequisites"><i class="fa fa-check"></i><b>1.1</b> Prerequisites</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#sources"><i class="fa fa-check"></i><b>1.2</b> Sources</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Generalized Lotka-Volterra</a><ul>
<li class="chapter" data-level="2.1" data-path="intro.html"><a href="intro.html#history"><i class="fa fa-check"></i><b>2.1</b> History</a></li>
<li class="chapter" data-level="2.2" data-path="intro.html"><a href="intro.html#basic-formulation"><i class="fa fa-check"></i><b>2.2</b> Basic formulation</a></li>
<li class="chapter" data-level="2.3" data-path="intro.html"><a href="intro.html#a-single-population"><i class="fa fa-check"></i><b>2.3</b> A single population</a><ul>
<li class="chapter" data-level="2.3.1" data-path="intro.html"><a href="intro.html#metapopulation-dynamics"><i class="fa fa-check"></i><b>2.3.1</b> Metapopulation dynamics</a></li>
<li class="chapter" data-level="2.3.2" data-path="intro.html"><a href="intro.html#s-i-s-model"><i class="fa fa-check"></i><b>2.3.2</b> S-I-S model</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="intro.html"><a href="intro.html#multi-species-dynamics"><i class="fa fa-check"></i><b>2.4</b> Multi-species dynamics</a><ul>
<li class="chapter" data-level="2.4.1" data-path="intro.html"><a href="intro.html#existence-of-an-equilibrium"><i class="fa fa-check"></i><b>2.4.1</b> Existence of an equilibrium</a></li>
<li class="chapter" data-level="2.4.2" data-path="intro.html"><a href="intro.html#stability-of-an-equilibrium"><i class="fa fa-check"></i><b>2.4.2</b> Stability of an equilibrium</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="intro.html"><a href="intro.html#types-of-dynamics"><i class="fa fa-check"></i><b>2.5</b> Types of dynamics</a></li>
<li class="chapter" data-level="2.6" data-path="intro.html"><a href="intro.html#the-equilibrium-is-the-time-average"><i class="fa fa-check"></i><b>2.6</b> The equilibrium is the time-average</a><ul>
<li class="chapter" data-level="2.6.1" data-path="intro.html"><a href="intro.html#d-stability-and-lyapunov-function"><i class="fa fa-check"></i><b>2.6.1</b> D-stability and Lyapunov function</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="intro.html"><a href="intro.html#stability-of-large-random-communities"><i class="fa fa-check"></i><b>2.7</b> Stability of large random communities</a></li>
<li class="chapter" data-level="2.8" data-path="intro.html"><a href="intro.html#further-readings"><i class="fa fa-check"></i><b>2.8</b> Further readings</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="multi.html"><a href="multi.html"><i class="fa fa-check"></i><b>3</b> Multispecies GLV</a><ul>
<li class="chapter" data-level="3.1" data-path="multi.html"><a href="multi.html#feasibility"><i class="fa fa-check"></i><b>3.1</b> Feasibility</a></li>
<li class="chapter" data-level="3.2" data-path="multi.html"><a href="multi.html#stability"><i class="fa fa-check"></i><b>3.2</b> Stability</a></li>
<li class="chapter" data-level="3.3" data-path="multi.html"><a href="multi.html#non-invasibility"><i class="fa fa-check"></i><b>3.3</b> Non-invasibility</a></li>
<li class="chapter" data-level="3.4" data-path="multi.html"><a href="multi.html#assembly"><i class="fa fa-check"></i><b>3.4</b> Assembly</a></li>
<li class="chapter" data-level="3.5" data-path="multi.html"><a href="multi.html#a-random-zoo"><i class="fa fa-check"></i><b>3.5</b> A random zoo</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="games.html"><a href="games.html"><i class="fa fa-check"></i><b>4</b> Evolutionary Game Theory</a><ul>
<li class="chapter" data-level="4.1" data-path="games.html"><a href="games.html#game-theory"><i class="fa fa-check"></i><b>4.1</b> Game theory</a></li>
<li class="chapter" data-level="4.2" data-path="games.html"><a href="games.html#nash-equilibria"><i class="fa fa-check"></i><b>4.2</b> Nash Equilibria</a></li>
<li class="chapter" data-level="4.3" data-path="games.html"><a href="games.html#evolutionary-game-theory"><i class="fa fa-check"></i><b>4.3</b> Evolutionary game theory</a></li>
<li class="chapter" data-level="4.4" data-path="games.html"><a href="games.html#replicator-dynamics"><i class="fa fa-check"></i><b>4.4</b> Replicator dynamics</a><ul>
<li class="chapter" data-level="4.4.1" data-path="games.html"><a href="games.html#rock-paper-scissor"><i class="fa fa-check"></i><b>4.4.1</b> Rock-paper-scissor</a></li>
<li class="chapter" data-level="4.4.2" data-path="games.html"><a href="games.html#multiple-species"><i class="fa fa-check"></i><b>4.4.2</b> Multiple species</a></li>
<li class="chapter" data-level="4.4.3" data-path="games.html"><a href="games.html#higher-order-interactions"><i class="fa fa-check"></i><b>4.4.3</b> Higher-order interactions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="data.html"><a href="data.html"><i class="fa fa-check"></i><b>5</b> Simple models for synthetic communities</a><ul>
<li class="chapter" data-level="5.1" data-path="data.html"><a href="data.html#fitting-absolute-abundances"><i class="fa fa-check"></i><b>5.1</b> Fitting absolute abundances</a></li>
<li class="chapter" data-level="5.2" data-path="data.html"><a href="data.html#fitting-relative-abundances"><i class="fa fa-check"></i><b>5.2</b> Fitting relative abundances</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">A tour of the Generalized Lotka-Volterra Model</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="intro" class="section level1">
<h1><span class="header-section-number">Chapter 2</span> Generalized Lotka-Volterra</h1>
<div id="history" class="section level2">
<h2><span class="header-section-number">2.1</span> History</h2>
</div>
<div id="basic-formulation" class="section level2">
<h2><span class="header-section-number">2.2</span> Basic formulation</h2>
<p>We can write the Generalized Lotka-Volterra model in a compact form as:</p>
<p><span class="math display">\[
\dfrac{dx(t)}{dt} = D(x(t))(r + A x(t))
\]</span></p>
<p>where <span class="math inline">\(x(t)\)</span> is a (column) vector of length <span class="math inline">\(n\)</span> containing the densities of all populations <span class="math inline">\(1, \ldots, n\)</span> at time <span class="math inline">\(t\)</span>, <span class="math inline">\(r\)</span> is a vector of “intrinsic growth rates” (or death rates, when negative), measuring the growth (decline) of population <span class="math inline">\(i\)</span> when grown alone at low density, and <span class="math inline">\(A\)</span> is a <span class="math inline">\(n \times n\)</span> matrix of interaction coefficients. We use <span class="math inline">\(D(x)\)</span> to denote the diagonal matrix with <span class="math inline">\(x\)</span> on the diagonal.</p>
</div>
<div id="a-single-population" class="section level2">
<h2><span class="header-section-number">2.3</span> A single population</h2>
<p>The simplest case to study is that of a single population, in which case the equation becomes that of the logistic growth:</p>
<p><span class="math display">\[
\dfrac{dx(t)}{dt} = x(t)(r + a x(t))
\]</span></p>
<p>This is a separable ODE, with solution:</p>
<p><span class="math display">\[
x(t) = \frac{r}{e^{-r \left(k+t\right)}-a}
\]</span>
where <span class="math inline">\(k\)</span> is a constant. Setting <span class="math inline">\(x(0) = x_0\)</span> (i.e., providing an initial condition), solving for the constant and substituting:</p>
<p><span class="math display">\[
x(t) = \frac{r {x_0} e^{r t}}{r-a {x_0} \left(e^{r t}-1\right)}
\]</span>
As such, provided with the parameters <span class="math inline">\(r\)</span> and <span class="math inline">\(a\)</span>, as well as an initial condition, we can determine the population size for any time <span class="math inline">\(t\)</span>. For example, in <code>R</code>:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="intro.html#cb1-1"></a><span class="kw">library</span>(deSolve) <span class="co"># integrate ODEs</span></span>
<span id="cb1-2"><a href="intro.html#cb1-2"></a><span class="kw">library</span>(tidyverse) <span class="co"># plotting and wrangling</span></span>
<span id="cb1-3"><a href="intro.html#cb1-3"></a><span class="co"># define the differential equation</span></span>
<span id="cb1-4"><a href="intro.html#cb1-4"></a>logistic_growth &lt;-<span class="st"> </span><span class="cf">function</span>(t, x, parameters){</span>
<span id="cb1-5"><a href="intro.html#cb1-5"></a>  <span class="kw">with</span>(<span class="kw">as.list</span>(<span class="kw">c</span>(x, parameters)), {</span>
<span id="cb1-6"><a href="intro.html#cb1-6"></a>    dxdt &lt;-<span class="st"> </span>x <span class="op">*</span><span class="st"> </span>(r <span class="op">+</span><span class="st"> </span>a <span class="op">*</span><span class="st"> </span>x)</span>
<span id="cb1-7"><a href="intro.html#cb1-7"></a>    <span class="kw">list</span>(dxdt)</span>
<span id="cb1-8"><a href="intro.html#cb1-8"></a>  })</span>
<span id="cb1-9"><a href="intro.html#cb1-9"></a>}</span>
<span id="cb1-10"><a href="intro.html#cb1-10"></a><span class="co"># define parameters, integration time, initial conditions</span></span>
<span id="cb1-11"><a href="intro.html#cb1-11"></a>times &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">100</span>, <span class="dt">by =</span> <span class="dv">5</span>)</span>
<span id="cb1-12"><a href="intro.html#cb1-12"></a>x0 &lt;-<span class="st"> </span><span class="fl">0.05</span></span>
<span id="cb1-13"><a href="intro.html#cb1-13"></a>r &lt;-<span class="st"> </span><span class="fl">0.1</span></span>
<span id="cb1-14"><a href="intro.html#cb1-14"></a>a &lt;-<span class="st"> </span><span class="fl">-0.05</span></span>
<span id="cb1-15"><a href="intro.html#cb1-15"></a>parameters &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">r =</span> r, <span class="dt">a =</span> a)</span>
<span id="cb1-16"><a href="intro.html#cb1-16"></a><span class="co"># solve numerically</span></span>
<span id="cb1-17"><a href="intro.html#cb1-17"></a>out &lt;-<span class="st"> </span><span class="kw">ode</span>(<span class="dt">y =</span> x0, <span class="dt">times =</span> times, </span>
<span id="cb1-18"><a href="intro.html#cb1-18"></a>           <span class="dt">func =</span> logistic_growth, <span class="dt">parms =</span> parameters, </span>
<span id="cb1-19"><a href="intro.html#cb1-19"></a>           <span class="dt">method =</span> <span class="st">&quot;ode45&quot;</span>)</span>
<span id="cb1-20"><a href="intro.html#cb1-20"></a><span class="co"># now compute analytically</span></span>
<span id="cb1-21"><a href="intro.html#cb1-21"></a>solution &lt;-<span class="st"> </span>r <span class="op">*</span><span class="st"> </span>x0 <span class="op">*</span><span class="st"> </span><span class="kw">exp</span>(r <span class="op">*</span><span class="st"> </span>times) <span class="op">/</span><span class="st"> </span>(r <span class="op">-</span><span class="st"> </span>a <span class="op">*</span><span class="st"> </span>x0 <span class="op">*</span><span class="st"> </span>(<span class="kw">exp</span>(r <span class="op">*</span><span class="st"> </span>times) <span class="op">-</span><span class="st"> </span><span class="dv">1</span>))</span>
<span id="cb1-22"><a href="intro.html#cb1-22"></a><span class="co"># use ggplot to plot</span></span>
<span id="cb1-23"><a href="intro.html#cb1-23"></a>res &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">time =</span> out[,<span class="dv">1</span>], <span class="dt">x_t =</span> out[,<span class="dv">2</span>], <span class="dt">x_sol =</span> solution)</span>
<span id="cb1-24"><a href="intro.html#cb1-24"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> res) <span class="op">+</span><span class="st"> </span><span class="kw">aes</span>(<span class="dt">x =</span> time, <span class="dt">y =</span> x_t) <span class="op">+</span><span class="st"> </span></span>
<span id="cb1-25"><a href="intro.html#cb1-25"></a><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb1-26"><a href="intro.html#cb1-26"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x =</span> time, <span class="dt">y =</span> x_sol), <span class="dt">colour =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">shape =</span> <span class="dv">2</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb1-27"><a href="intro.html#cb1-27"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="kw">expression</span>(<span class="st">&quot;x(t)&quot;</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="kw">expression</span>(<span class="st">&quot;t&quot;</span>))</span></code></pre></div>
<p><img src="A-tour-of-the-Generalized-Lotka-Volterra-Model_files/figure-html/unnamed-chunk-1-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>If <span class="math inline">\(a &lt; 0\)</span> and <span class="math inline">\(r &gt; 0\)</span>, the population started at any positive value eventually reaches an equilibrium, which we can find by setting <span class="math inline">\(dx(t)/dt = 0\)</span> and considering <span class="math inline">\(x \neq 0\)</span>:</p>
<p><span class="math display">\[
(r + a x) = 0 \to x = -\frac{r}{a}
\]</span></p>
<div id="metapopulation-dynamics" class="section level3">
<h3><span class="header-section-number">2.3.1</span> Metapopulation dynamics</h3>
<p>Consider a fragmented landscape in which habitable patches are connected by dispersal (for simplicity, suppose that all patches are reachable from any other). Call <span class="math inline">\(p(t)\)</span> the proportion of patches occupied by the species of interest at time <span class="math inline">\(t\)</span>, and assume that a) an empty patch (the proportion of empty patches is <span class="math inline">\(1 - p(t)\)</span>) is colonized by the species with rate <span class="math inline">\(c p(t)\)</span>, where <span class="math inline">\(c\)</span> is the “colonization rate”, and b) that occupied patches become empty at rate <span class="math inline">\(e p(t)\)</span> (“extinction rate”). We want to model the proportion of patches occupied by the population at time <span class="math inline">\(t\)</span>:</p>
<p><span class="math display">\[
\dfrac{d p(t)}{dt} = c p(t)(1 - p(t)) - e p(t) = p(t) (c - (c + e) p(t))
\]</span></p>
<p>which is equivalent to the logistic equation above with <span class="math inline">\(r = c\)</span> and <span class="math inline">\(a = -(c+e)\)</span>. As such, asymptotically the proportion of patches occupied by the population will be <span class="math inline">\(-r/a = c / (c + e)\)</span>.</p>
</div>
<div id="s-i-s-model" class="section level3">
<h3><span class="header-section-number">2.3.2</span> S-I-S model</h3>
<p>Consider a population of individuals, each of which can be in one of two states: susceptible, or infective/infected. Call <span class="math inline">\(S(t)\)</span> the proportion of susceptible individuals at time <span class="math inline">\(t\)</span>, and <span class="math inline">\(I(t)\)</span> the proportion of infected individuals, with <span class="math inline">\(S(t) + I(t) = 1\)</span>. When individuals meet an infected individual can transmit the disease with rate <span class="math inline">\(\beta\)</span>; infected individuals recover from the disease with rate <span class="math inline">\(\gamma\)</span>, and return susceptible. We can write the system of equations:</p>
<p><span class="math display">\[
\begin{cases}
\dfrac{d S(t)}{dt} = -\beta S(t) I(t) + \gamma I(t)\\
\dfrac{d I(t)}{dt} = \beta S(t) I(t) - \gamma I(t)
\end{cases}
\]</span></p>
<p>take the second equation, and substitute <span class="math inline">\(S(t) = 1 - I(t)\)</span>; rearranging:</p>
<p><span class="math display">\[
\dfrac{d I(t)}{dt} = \beta (1-I(t)) I(t) - \gamma I(t) = I(t)(\beta - \gamma -\beta I(t))
\]</span></p>
<p>which is again the equation for the logistic growth with <span class="math inline">\(r = \beta - \gamma\)</span> and <span class="math inline">\(a = -\beta\)</span>. As such, provided that <span class="math inline">\(\beta -\gamma &gt; 0\)</span>, a fraction <span class="math inline">\((\beta - \gamma) / \beta\)</span> of individuals will be infected. The condition <span class="math inline">\(\beta -\gamma &gt; 0 \to \beta &gt; \gamma \to \beta/ \gamma &gt; 1\)</span> is often written as <span class="math inline">\(\mathcal R_0 = \beta/ \gamma &gt; 1\)</span>.</p>
</div>
</div>
<div id="multi-species-dynamics" class="section level2">
<h2><span class="header-section-number">2.4</span> Multi-species dynamics</h2>
<div id="existence-of-an-equilibrium" class="section level3">
<h3><span class="header-section-number">2.4.1</span> Existence of an equilibrium</h3>
<p>Returning to the multi-species system, and in analogy with the single species, we can look for stationary points (equilibria). If the matrix <span class="math inline">\(A\)</span> is not singular, then we can look for a solution of <span class="math inline">\(r + Ax\)</span> that has positive components (called a <strong>feasible equilibrium</strong>). If such point exists, it is unique and is the solution of <span class="math inline">\(Ax^\star = -r\)</span>, <span class="math inline">\(x^\star = -A^{-1}r\)</span>.</p>
<p>Suppose that the GLV has no feasible equilibrium. Then all trajectories (if bounded; some could grow to infinity) reach the boundary of <span class="math inline">\(\mathbb R^n_{0+}\)</span>. Practically, this means that <strong>to ensure coexistence of all species, it is necessary to have an equilibrium in the interior <span class="math inline">\(\mathbb R^n_{+}\)</span></strong>.</p>
</div>
<div id="stability-of-an-equilibrium" class="section level3">
<h3><span class="header-section-number">2.4.2</span> Stability of an equilibrium</h3>
<p>Suppose that a feasible equilibrium <span class="math inline">\(x^\star\)</span> exists. Then we can ask whether it is attractive, i.e. if trajectories started at initial condition <span class="math inline">\(x(0)\)</span> will eventually reach <span class="math inline">\(x^\star\)</span>. This problem is in general difficult to solve (but see below); as an alternative we can test for local asymptotic stability, i.e., ask whether the system will return to the equilibrium if perturbed infinitesimally away from it. In general, whenever we describe an ecological community as a system of nonlinear, autonomous ODEs:</p>
<p><span class="math display">\[
\frac{d x_i (t)}{d t} = f_i (x(t)) \;,
\]</span></p>
<p>we define an equilibrium <span class="math inline">\(x^\star\)</span> as a vector of densities such that:</p>
<p><span class="math display">\[
\left. \frac{d x_i}{d t} \right|_{{x}^\star} = f_i
({x}^\star) = 0 \quad \forall i
\]</span></p>
<p>A given system might have a multitude of equilibria. When the system is resting at an equilibrium point, it will remain there unless it is perturbed away from it. Local stability analysis is a method to probe whether a system that is perturbed infinitesimally away from an equilibrium will eventually return to it, or rather move away from it.</p>
<p>DERIVATION HERE</p>
<p>The analysis is based on the Jacobian matrix of the system <span class="math inline">\(J\)</span>, whose elements are defined as:</p>
<p><span class="math display">\[
J_{ij} = \frac{\partial f_i({x})}{\partial x_j} 
\]</span></p>
<p>Each element of this matrix is therefore a function, whose value depends on <span class="math inline">\({x}\)</span>. When we evaluate the Jacobian matrix at an equilibrium point <span class="math inline">\({x}^\star\)</span>, we obtain the so-called “community matrix” <span class="math inline">\({M}\)</span>:</p>
<p><span class="math display">\[
  M = \left. {J} \right|_{ {x}^\star}
\]</span>
Note that, although each system has a unique Jacobian matrix, there are as many community matrices as there are equilibria. The community
matrix details the effect of increasing density of one species on any other species around the equilibrium point.</p>
<p>The most notable property of the community matrix is that its eigenvalues determine the stability of the equilibrium <span class="math inline">\({x}^\star\)</span>: if all the eigenvalues have negative real part, then the system will eventually return to the equilibrium after sufficiently small perturbations; conversely, if any of the eigenvalues have positive real part, the system will move away from the equilibrium whenever perturbed. Therefore, depending on the sign of the “rightmost” eigenvalue of <span class="math inline">\({M}\)</span>, <span class="math inline">\(\lambda_1\)</span>, we can determine the stability of <span class="math inline">\({x}^\star\)</span>:</p>
<p><span class="math display">\[
  \text{Re}(\lambda_1) \begin{cases}
    &lt; 0 \to {x}^\star \quad \text{is stable}\\
    &gt; 0 \to {x}^\star \quad \text{is unstable}
  \end{cases}
\]</span></p>
<p>Local asymptotic stability means that the equilibrium is stable with respect to infinitesimal perturbations (“local”), and that returning
to the equilibrium could take a long time (“asymptotic”). Ecologists have also studied stronger forms of stability (e.g., “global stability”, in which all trajectories started at positive densities lead to the equilibrium).</p>
<p>For the GLV model, the Jacobian is easy to compute:</p>
<p><span class="math display">\[
J_{ij} = \frac{\partial f_i}{\partial x_j} = a_{ij} x_i
\]</span></p>
<p>and</p>
<p><span class="math display">\[
J_{ij} = \frac{\partial f_i}{\partial x_i} = r_i + \sum_j a_{ij} x_j + a_{ii} x_i
\]</span></p>
<p>At equilibrium <span class="math inline">\(r_i + \sum_j a_{ij} x_j = 0\)</span>, and therefore:</p>
<p><span class="math display">\[
M = \left. {J} \right|_{ {x}^\star} = D(x^\star)A
\]</span></p>
</div>
</div>
<div id="types-of-dynamics" class="section level2">
<h2><span class="header-section-number">2.5</span> Types of dynamics</h2>
<p>For a single population, there are only three types of dynamics that can be displayed by a GLV model: either the population grows to infinity, shrinks to zero, or asymptotically reaches a steady state.</p>
<p><span class="citation">Smale (<a href="#ref-smale1976differential" role="doc-biblioref">1976</a>)</span> and <span class="citation">Hirsch (<a href="#ref-hirsch1982systems" role="doc-biblioref">1982</a>)</span> showed that limit cylces are possible for three or more species, and that any dynamics can be found for competitive GLV systems with five or more species.</p>
<p>The code necessary for some numerical explorations:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="intro.html#cb2-1"></a><span class="co"># Generalized Lotka-Volterra model</span></span>
<span id="cb2-2"><a href="intro.html#cb2-2"></a>GLV &lt;-<span class="st"> </span><span class="cf">function</span>(t, x, parameters){</span>
<span id="cb2-3"><a href="intro.html#cb2-3"></a>  <span class="kw">with</span>(<span class="kw">as.list</span>(<span class="kw">c</span>(x, parameters)), {</span>
<span id="cb2-4"><a href="intro.html#cb2-4"></a>    x[x <span class="op">&lt;</span><span class="st"> </span><span class="dv">10</span><span class="op">^-</span><span class="dv">8</span>] &lt;-<span class="st"> </span><span class="dv">0</span> <span class="co"># prevent numerical problems</span></span>
<span id="cb2-5"><a href="intro.html#cb2-5"></a>    dxdt &lt;-<span class="st"> </span>x <span class="op">*</span><span class="st"> </span>(r <span class="op">+</span><span class="st"> </span>A <span class="op">%*%</span><span class="st"> </span>x)</span>
<span id="cb2-6"><a href="intro.html#cb2-6"></a>    <span class="kw">list</span>(dxdt)</span>
<span id="cb2-7"><a href="intro.html#cb2-7"></a>  })</span>
<span id="cb2-8"><a href="intro.html#cb2-8"></a>}</span>
<span id="cb2-9"><a href="intro.html#cb2-9"></a><span class="co"># function to plot output</span></span>
<span id="cb2-10"><a href="intro.html#cb2-10"></a>plot_ODE_output &lt;-<span class="st"> </span><span class="cf">function</span>(out){</span>
<span id="cb2-11"><a href="intro.html#cb2-11"></a>  out &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(out)</span>
<span id="cb2-12"><a href="intro.html#cb2-12"></a>  <span class="kw">colnames</span>(out) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;time&quot;</span>, <span class="kw">paste</span>(<span class="st">&quot;sp&quot;</span>, <span class="dv">1</span><span class="op">:</span>(<span class="kw">ncol</span>(out) <span class="dv">-1</span>), <span class="dt">sep =</span> <span class="st">&quot;_&quot;</span>))</span>
<span id="cb2-13"><a href="intro.html#cb2-13"></a>  out &lt;-<span class="st"> </span><span class="kw">as_tibble</span>(out) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">gather</span>(species, density, <span class="op">-</span>time)</span>
<span id="cb2-14"><a href="intro.html#cb2-14"></a>  pl &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> out) <span class="op">+</span><span class="st"> </span></span>
<span id="cb2-15"><a href="intro.html#cb2-15"></a><span class="st">    </span><span class="kw">aes</span>(<span class="dt">x =</span> time, <span class="dt">y =</span> density, <span class="dt">colour =</span> species) <span class="op">+</span><span class="st"> </span></span>
<span id="cb2-16"><a href="intro.html#cb2-16"></a><span class="st">    </span><span class="kw">geom_line</span>()</span>
<span id="cb2-17"><a href="intro.html#cb2-17"></a>  <span class="kw">show</span>(pl)</span>
<span id="cb2-18"><a href="intro.html#cb2-18"></a>  <span class="kw">return</span>(out)</span>
<span id="cb2-19"><a href="intro.html#cb2-19"></a>}</span>
<span id="cb2-20"><a href="intro.html#cb2-20"></a><span class="co"># general function to integrate GLV</span></span>
<span id="cb2-21"><a href="intro.html#cb2-21"></a>integrate_GLV &lt;-<span class="st"> </span><span class="cf">function</span>(r, A, x0, <span class="dt">maxtime =</span> <span class="dv">100</span>, <span class="dt">steptime =</span> <span class="fl">0.5</span>){</span>
<span id="cb2-22"><a href="intro.html#cb2-22"></a>  times &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, maxtime, <span class="dt">by =</span> steptime)</span>
<span id="cb2-23"><a href="intro.html#cb2-23"></a>  parameters &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">r =</span> r, <span class="dt">A =</span> A)</span>
<span id="cb2-24"><a href="intro.html#cb2-24"></a>  <span class="co"># solve numerically</span></span>
<span id="cb2-25"><a href="intro.html#cb2-25"></a>  out &lt;-<span class="st"> </span><span class="kw">ode</span>(<span class="dt">y =</span> x0, <span class="dt">times =</span> times, </span>
<span id="cb2-26"><a href="intro.html#cb2-26"></a>           <span class="dt">func =</span> GLV, <span class="dt">parms =</span> parameters, </span>
<span id="cb2-27"><a href="intro.html#cb2-27"></a>           <span class="dt">method =</span> <span class="st">&quot;ode45&quot;</span>)</span>
<span id="cb2-28"><a href="intro.html#cb2-28"></a>  <span class="co"># plot and make into tidy form</span></span>
<span id="cb2-29"><a href="intro.html#cb2-29"></a>  out &lt;-<span class="st"> </span><span class="kw">plot_ODE_output</span>(out)</span>
<span id="cb2-30"><a href="intro.html#cb2-30"></a>  <span class="kw">return</span>(out)</span>
<span id="cb2-31"><a href="intro.html#cb2-31"></a>}</span></code></pre></div>
<p>A few examples taken from <span class="citation">Barabás, J. Michalska-Smith, and Allesina (<a href="#ref-barabas2016effect" role="doc-biblioref">2016</a>)</span>. First, a competitive system in which a feasible equilibrium does not exist, leading to the extinction of a species:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="intro.html#cb3-1"></a><span class="kw">set.seed</span>(<span class="dv">1</span>) <span class="co"># for reproducibility</span></span>
<span id="cb3-2"><a href="intro.html#cb3-2"></a>r_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">1</span>, <span class="dv">3</span>)</span>
<span id="cb3-3"><a href="intro.html#cb3-3"></a>A_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="op">-</span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">9</span>, <span class="dv">5</span>, </span>
<span id="cb3-4"><a href="intro.html#cb3-4"></a>                 <span class="dv">9</span>, <span class="dv">10</span>, <span class="dv">9</span>, </span>
<span id="cb3-5"><a href="intro.html#cb3-5"></a>                 <span class="dv">5</span>, <span class="dv">9</span>, <span class="dv">10</span>), <span class="dv">3</span>, <span class="dv">3</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>)</span>
<span id="cb3-6"><a href="intro.html#cb3-6"></a><span class="co"># check the existence of feasible equilibrium</span></span>
<span id="cb3-7"><a href="intro.html#cb3-7"></a><span class="kw">print</span>(<span class="kw">solve</span>(A_<span class="dv">1</span>, <span class="op">-</span>r_<span class="dv">1</span>)) <span class="co"># not feasible</span></span>
<span id="cb3-8"><a href="intro.html#cb3-8"></a>x0_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">3</span>)</span>
<span id="cb3-9"><a href="intro.html#cb3-9"></a>res_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">integrate_GLV</span>(r_<span class="dv">1</span>, A_<span class="dv">1</span>, x0_<span class="dv">1</span>)</span></code></pre></div>
<p><img src="A-tour-of-the-Generalized-Lotka-Volterra-Model_files/figure-html/unnamed-chunk-3-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre><code># [1] -0.08333333  0.25000000 -0.08333333</code></pre>
<p>Then, a case in which the equilibrium exists, and is attractive (stable):</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="intro.html#cb5-1"></a><span class="kw">set.seed</span>(<span class="dv">2</span>) <span class="co"># for reproducibility</span></span>
<span id="cb5-2"><a href="intro.html#cb5-2"></a>r_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">10</span>, <span class="dv">3</span>)</span>
<span id="cb5-3"><a href="intro.html#cb5-3"></a>A_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="op">-</span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">7</span>, <span class="dv">12</span>, </span>
<span id="cb5-4"><a href="intro.html#cb5-4"></a>                 <span class="dv">15</span>, <span class="dv">10</span>, <span class="dv">8</span>, </span>
<span id="cb5-5"><a href="intro.html#cb5-5"></a>                 <span class="dv">7</span>, <span class="dv">11</span>, <span class="dv">10</span>), <span class="dv">3</span>, <span class="dv">3</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>)</span>
<span id="cb5-6"><a href="intro.html#cb5-6"></a><span class="co"># check the existence of feasible equilibrium</span></span>
<span id="cb5-7"><a href="intro.html#cb5-7"></a><span class="kw">print</span>(<span class="kw">solve</span>(A_<span class="dv">2</span>, <span class="op">-</span>r_<span class="dv">2</span>)) <span class="co"># feasible</span></span>
<span id="cb5-8"><a href="intro.html#cb5-8"></a>x0_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">3</span>)</span>
<span id="cb5-9"><a href="intro.html#cb5-9"></a>res_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">integrate_GLV</span>(r_<span class="dv">2</span>, A_<span class="dv">2</span>, x0_<span class="dv">2</span>)</span></code></pre></div>
<p><img src="A-tour-of-the-Generalized-Lotka-Volterra-Model_files/figure-html/unnamed-chunk-4-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre><code># [1] 0.1661130 0.3654485 0.4817276</code></pre>
<p>With three competitors we can find stable limit cycles:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="intro.html#cb7-1"></a><span class="kw">set.seed</span>(<span class="dv">3</span>) <span class="co"># for reproducibility</span></span>
<span id="cb7-2"><a href="intro.html#cb7-2"></a>r_<span class="dv">3</span> &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">1</span>, <span class="dv">3</span>)</span>
<span id="cb7-3"><a href="intro.html#cb7-3"></a>A_<span class="dv">3</span> &lt;-<span class="st"> </span><span class="op">-</span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">6</span>, <span class="dv">12</span>, </span>
<span id="cb7-4"><a href="intro.html#cb7-4"></a>                 <span class="dv">14</span>, <span class="dv">10</span>, <span class="dv">2</span>, </span>
<span id="cb7-5"><a href="intro.html#cb7-5"></a>                 <span class="dv">8</span>, <span class="dv">18</span>, <span class="dv">10</span>), <span class="dv">3</span>, <span class="dv">3</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>)</span>
<span id="cb7-6"><a href="intro.html#cb7-6"></a><span class="co"># check the existence of feasible equilibrium</span></span>
<span id="cb7-7"><a href="intro.html#cb7-7"></a><span class="kw">print</span>(<span class="kw">solve</span>(A_<span class="dv">3</span>, <span class="op">-</span>r_<span class="dv">3</span>)) <span class="co"># feasible</span></span>
<span id="cb7-8"><a href="intro.html#cb7-8"></a>x0_<span class="dv">3</span> &lt;-<span class="st"> </span><span class="fl">0.1</span> <span class="op">*</span><span class="st"> </span><span class="kw">runif</span>(<span class="dv">3</span>)</span>
<span id="cb7-9"><a href="intro.html#cb7-9"></a>res_<span class="dv">3</span> &lt;-<span class="st"> </span><span class="kw">integrate_GLV</span>(r_<span class="dv">3</span>, A_<span class="dv">3</span>, x0_<span class="dv">3</span>, <span class="dt">maxtime =</span> <span class="dv">250</span>)</span></code></pre></div>
<p><img src="A-tour-of-the-Generalized-Lotka-Volterra-Model_files/figure-html/unnamed-chunk-5-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre><code># [1] 0.05714286 0.01428571 0.02857143</code></pre>
<p>And with four or more species we can have chaos:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="intro.html#cb9-1"></a><span class="kw">set.seed</span>(<span class="dv">4</span>) <span class="co"># for reproducibility</span></span>
<span id="cb9-2"><a href="intro.html#cb9-2"></a>r_<span class="dv">4</span> &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="fl">0.72</span>, <span class="fl">1.53</span>, <span class="fl">1.27</span>)</span>
<span id="cb9-3"><a href="intro.html#cb9-3"></a>A_<span class="dv">4</span> &lt;-<span class="st"> </span><span class="op">-</span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="fl">1.09</span>, <span class="fl">1.52</span>, <span class="dv">0</span>, </span>
<span id="cb9-4"><a href="intro.html#cb9-4"></a>                 <span class="dv">0</span>, <span class="fl">0.72</span>, <span class="fl">0.3168</span>, <span class="fl">0.9792</span>, </span>
<span id="cb9-5"><a href="intro.html#cb9-5"></a>                 <span class="fl">3.5649</span>, <span class="dv">0</span>, <span class="fl">1.53</span>, <span class="fl">0.7191</span>,</span>
<span id="cb9-6"><a href="intro.html#cb9-6"></a>                 <span class="fl">1.5367</span>, <span class="fl">0.6477</span>, <span class="fl">0.4445</span>, <span class="fl">1.27</span>), <span class="dv">4</span>, <span class="dv">4</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>)</span>
<span id="cb9-7"><a href="intro.html#cb9-7"></a><span class="co"># check the existence of feasible equilibrium</span></span>
<span id="cb9-8"><a href="intro.html#cb9-8"></a><span class="kw">print</span>(<span class="kw">solve</span>(A_<span class="dv">4</span>, <span class="op">-</span>r_<span class="dv">4</span>)) <span class="co"># feasible</span></span>
<span id="cb9-9"><a href="intro.html#cb9-9"></a>x0_<span class="dv">4</span> &lt;-<span class="st"> </span><span class="fl">0.1</span> <span class="op">*</span><span class="st"> </span><span class="kw">runif</span>(<span class="dv">4</span>)</span>
<span id="cb9-10"><a href="intro.html#cb9-10"></a>res_<span class="dv">4</span> &lt;-<span class="st"> </span><span class="kw">integrate_GLV</span>(r_<span class="dv">4</span>, A_<span class="dv">4</span>, x0_<span class="dv">4</span>, <span class="dt">maxtime =</span> <span class="dv">500</span>)</span></code></pre></div>
<p><img src="A-tour-of-the-Generalized-Lotka-Volterra-Model_files/figure-html/unnamed-chunk-6-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre><code># [1] 0.3013030 0.4586546 0.1307655 0.3557416</code></pre>
</div>
<div id="the-equilibrium-is-the-time-average" class="section level2">
<h2><span class="header-section-number">2.6</span> The equilibrium is the time-average</h2>
<p>Suppose that <span class="math inline">\(x(t)\)</span> has a periodic orbit of period <span class="math inline">\(T\)</span>. Further, assume that the GLV has an interior equilibrium <span class="math inline">\(x^\star\)</span>. We want to calculate the average density for each species:</p>
<p><span class="math display">\[
\frac{1}{T} \int_0^T x(t) dt
\]</span></p>
<p>We perform the change of variable <span class="math inline">\(y = \log(x(t))\)</span>, finding <span class="math inline">\(\frac{d x(t)}{dt} = \frac{d x(t)}{d \log(x(t))}\frac{d \log(x(t))}{dt} = x(t)\frac{d \log(x(t))}{dt}\)</span>. Then:</p>
<p><span class="math display">\[
\frac{d \log(x(t))}{dt} = r + Ax(t)
\]</span></p>
<p>Compute the average on both sides:</p>
<p><span class="math display">\[
\frac{1}{T}\int_0^T \frac{d \log(x(t))}{dt} dt= \frac{1}{T}\int_0^T \left(r + Ax \right) dt
\]</span></p>
<p>yielding:
<span class="math display">\[
\frac{1}{T}(\log(x(T)) - \log(x(0))) = 0 = r + A \left( \frac{1}{T} \int_0^T x(t) dt \right)
\]</span>
multiplying by the matrix inverse and rearranging:</p>
<p><span class="math display">\[
-A^{-1} r = x^\star =  \frac{1}{T} \int_0^T x(t) dt 
\]</span></p>
<p>showing that the average density is in fact the equilibrium. With a similar argument, one can prove that the trajectory stays in a compact space (i.e., in case of chaotic attractors), then long-time average is still <span class="math inline">\(x^\star\)</span>.</p>
<p>For example, let’s compute the average for the system with the limit cycle above (discarding the transients in the first part of the time series):</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="intro.html#cb11-1"></a>res_<span class="dv">3</span> <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(time <span class="op">&gt;</span><span class="st"> </span><span class="dv">50</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb11-2"><a href="intro.html#cb11-2"></a><span class="st">  </span><span class="kw">group_by</span>(species) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb11-3"><a href="intro.html#cb11-3"></a><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">average =</span> <span class="kw">mean</span>(density))</span>
<span id="cb11-4"><a href="intro.html#cb11-4"></a><span class="co"># compare with equilibrium</span></span>
<span id="cb11-5"><a href="intro.html#cb11-5"></a><span class="kw">solve</span>(A_<span class="dv">3</span>, <span class="op">-</span>r_<span class="dv">3</span>)</span></code></pre></div>
<pre><code># # A tibble: 3 x 2
#   species average
#   &lt;chr&gt;     &lt;dbl&gt;
# 1 sp_1     0.0568
# 2 sp_2     0.0147
# 3 sp_3     0.0284
# [1] 0.05714286 0.01428571 0.02857143</code></pre>
<p>Repeat for the chaotic system:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="intro.html#cb13-1"></a>res_<span class="dv">4</span> <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(time <span class="op">&gt;</span><span class="st"> </span><span class="dv">50</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb13-2"><a href="intro.html#cb13-2"></a><span class="st">  </span><span class="kw">group_by</span>(species) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb13-3"><a href="intro.html#cb13-3"></a><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">average =</span> <span class="kw">mean</span>(density))</span>
<span id="cb13-4"><a href="intro.html#cb13-4"></a><span class="co"># compare with equilibrium</span></span>
<span id="cb13-5"><a href="intro.html#cb13-5"></a><span class="kw">solve</span>(A_<span class="dv">4</span>, <span class="op">-</span>r_<span class="dv">4</span>)</span></code></pre></div>
<pre><code># # A tibble: 4 x 2
#   species average
#   &lt;chr&gt;     &lt;dbl&gt;
# 1 sp_1      0.303
# 2 sp_2      0.463
# 3 sp_3      0.126
# 4 sp_4      0.354
# [1] 0.3013030 0.4586546 0.1307655 0.3557416</code></pre>
<div id="d-stability-and-lyapunov-function" class="section level3">
<h3><span class="header-section-number">2.6.1</span> D-stability and Lyapunov function</h3>
<p>Suppose that there is a positive vector <span class="math inline">\(y\)</span> such that <span class="math inline">\(D(y) A + A^t D(y)\)</span> is negative definite (i.e., has only negative eigenvalues; the eigenvalues are real because the matrix is symmetric). Further, suppose that the GLV system with parameters <span class="math inline">\(A\)</span> and <span class="math inline">\(r\)</span> has a feasible equilibrium point <span class="math inline">\(x^\star\)</span>. Then the function</p>
<p><span class="math display">\[
V(x(t)) = \sum_i y_i (x_i(t) - {x}_i^\star \log x_i(t))
\]</span>
is a Lyapunov function for the GLV system.</p>
<p>To prove this point, we start from <span class="math inline">\(r = -Ax^\star\)</span>. Substituting, we can write the GLV system as <span class="math inline">\(dx(t)/dt = D(x)A(x - x^\star)\)</span></p>
</div>
</div>
<div id="stability-of-large-random-communities" class="section level2">
<h2><span class="header-section-number">2.7</span> Stability of large random communities</h2>
<p>As we have seen above, an equilibrium <span class="math inline">\(x^\star\)</span> is stable if the community matrix for the equilibrium has all eigenvalues with negative real part. In general, to determine the equilibrium and its stability, we would need to specify all the growth rates (<span class="math inline">\(r\)</span>, <span class="math inline">\(n\)</span> values), as well as the matrix of interactions (<span class="math inline">\(A\)</span>, <span class="math inline">\(n^2\)</span> values). This is impractical to do for large systems (though we will try this out later). But can something quite general be said about the limit in which many species are in the community?</p>
<p><span class="citation">May (<a href="#ref-may1972will" role="doc-biblioref">1972</a>)</span> attempted to answer this question by considering a random community matrix. In a GLV system, the diagonal elements <span class="math inline">\(m_{ii} = a_{ii} x_i^\star\)</span> are influenced by self-regulation (i.e., as in a carrying capacity), while the off-diagonal elements <span class="math inline">\(m_{ij} = a_{ij} x_i^\star\)</span> model the effect of species <span class="math inline">\(j\)</span> on the equilibrium of species <span class="math inline">\(i\)</span>. May considered the following algorithm to build a random community matrix. Take a large community, resting at an unspecified equilibrium; we build the community matrix by setting</p>
<ul>
<li><span class="math inline">\(m_{ij} = 0\)</span> with probability <span class="math inline">\((1-C)\)</span>; with probability <span class="math inline">\(C\)</span> we draw <span class="math inline">\(m_{ij}\)</span> from a distribution with mean zero and variance <span class="math inline">\(\sigma^2\)</span>. <span class="math inline">\(C\)</span> is the proportion of realized connections, termed the “connectance” of the system.</li>
<li>the diagonal elements are set to <span class="math inline">\(-d\)</span>, modeling self-regulation.</li>
</ul>
<p>For example, the code uses a normal distribution:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="intro.html#cb15-1"></a>build_May_normal &lt;-<span class="st"> </span><span class="cf">function</span>(n, C, d, sigma){</span>
<span id="cb15-2"><a href="intro.html#cb15-2"></a>  <span class="co"># fill the whole matrix</span></span>
<span id="cb15-3"><a href="intro.html#cb15-3"></a>  M &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n <span class="op">*</span><span class="st"> </span>n, <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> sigma), n, n)</span>
<span id="cb15-4"><a href="intro.html#cb15-4"></a>  <span class="co"># remove connections </span></span>
<span id="cb15-5"><a href="intro.html#cb15-5"></a>  M &lt;-<span class="st"> </span>M <span class="op">*</span><span class="st"> </span><span class="kw">matrix</span>(<span class="kw">runif</span>(n <span class="op">*</span><span class="st"> </span>n) <span class="op">&lt;=</span><span class="st"> </span>C, n, n)</span>
<span id="cb15-6"><a href="intro.html#cb15-6"></a>  <span class="co"># set diagonals</span></span>
<span id="cb15-7"><a href="intro.html#cb15-7"></a>  <span class="kw">diag</span>(M) &lt;-<span class="st"> </span><span class="op">-</span>d</span>
<span id="cb15-8"><a href="intro.html#cb15-8"></a>  <span class="kw">return</span>(M)</span>
<span id="cb15-9"><a href="intro.html#cb15-9"></a>}</span></code></pre></div>
<p>We want to determine whether the equilibrium will be stable, given <span class="math inline">\(n\)</span>, <span class="math inline">\(C\)</span>, <span class="math inline">\(d\)</span> and <span class="math inline">\(\sigma^2\)</span>. To do so, we need to find the location of the “rightmost” eigenvalue of <span class="math inline">\(M\)</span>. For example, let’s plot the eigenvalues of a large matrix:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="intro.html#cb16-1"></a>plot_eigenvalues &lt;-<span class="st"> </span><span class="cf">function</span>(M, <span class="dt">prediction =</span> <span class="ot">NULL</span>){</span>
<span id="cb16-2"><a href="intro.html#cb16-2"></a>  eig &lt;-<span class="st"> </span><span class="kw">eigen</span>(M, <span class="dt">only.values =</span> <span class="ot">TRUE</span>)<span class="op">$</span>values</span>
<span id="cb16-3"><a href="intro.html#cb16-3"></a>  dt &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">Real =</span> <span class="kw">Re</span>(eig), <span class="dt">Imaginary =</span> <span class="kw">Im</span>(eig))</span>
<span id="cb16-4"><a href="intro.html#cb16-4"></a>  pl &lt;-<span class="st"> </span><span class="kw">ggplot</span>(dt) <span class="op">+</span><span class="st"> </span><span class="kw">aes</span>(<span class="dt">x =</span> Real, <span class="dt">y =</span> Imaginary) <span class="op">+</span><span class="st"> </span></span>
<span id="cb16-5"><a href="intro.html#cb16-5"></a><span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb16-6"><a href="intro.html#cb16-6"></a><span class="st">    </span><span class="kw">coord_equal</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb16-7"><a href="intro.html#cb16-7"></a><span class="st">    </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">0</span>, <span class="dt">colour =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">linetype =</span> <span class="dv">2</span>)</span>
<span id="cb16-8"><a href="intro.html#cb16-8"></a>  <span class="cf">if</span> (<span class="kw">is.null</span>(prediction) <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span>) {</span>
<span id="cb16-9"><a href="intro.html#cb16-9"></a>    pl &lt;-<span class="st"> </span>pl <span class="op">+</span><span class="st"> </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> prediction, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">linetype =</span> <span class="dv">2</span>)</span>
<span id="cb16-10"><a href="intro.html#cb16-10"></a>  }</span>
<span id="cb16-11"><a href="intro.html#cb16-11"></a>  <span class="kw">show</span>(pl)</span>
<span id="cb16-12"><a href="intro.html#cb16-12"></a>}</span>
<span id="cb16-13"><a href="intro.html#cb16-13"></a><span class="kw">set.seed</span>(<span class="dv">100</span>) <span class="co"># for reproducibility</span></span>
<span id="cb16-14"><a href="intro.html#cb16-14"></a><span class="co"># parameters</span></span>
<span id="cb16-15"><a href="intro.html#cb16-15"></a>n &lt;-<span class="st"> </span><span class="dv">500</span></span>
<span id="cb16-16"><a href="intro.html#cb16-16"></a>C &lt;-<span class="st"> </span><span class="fl">0.5</span></span>
<span id="cb16-17"><a href="intro.html#cb16-17"></a>d &lt;-<span class="st"> </span><span class="dv">10</span></span>
<span id="cb16-18"><a href="intro.html#cb16-18"></a>sigma &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb16-19"><a href="intro.html#cb16-19"></a>M &lt;-<span class="st"> </span><span class="kw">build_May_normal</span>(n, C, d, sigma)</span>
<span id="cb16-20"><a href="intro.html#cb16-20"></a><span class="kw">plot_eigenvalues</span>(M)</span></code></pre></div>
<p><img src="A-tour-of-the-Generalized-Lotka-Volterra-Model_files/figure-html/unnamed-chunk-10-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>The eigenvalues fall into an almost perfect circle! Turns out, that this is the behavior we should expect, as stated by the so-called “Circular Law”, one of the most beautiful results in random matrix theory.</p>
<p><strong>Circular law:</strong> Take a non-symmetric, <span class="math inline">\(S \times S\)</span> random matrix in which all coefficients <span class="math inline">\(X_{ij}\)</span> are i.i.d. random variables with <span class="math inline">\(\mathbb E[X_{ij}] = 0\)</span> and <span class="math inline">\(\mathbb E[X_{ij}] = 1\)</span>. Then, as <span class="math inline">\(S \to \infty\)</span>, the e.s.d. of <span class="math inline">\({X} / \sqrt{S}\)</span> converges to the circular law:</p>
<p><span class="math display">\[
  \mu(\lambda) = \begin{cases}
    \frac{1}{\pi} \; \; \; \text{if} \; (\text{Re}(\lambda))^2 +
    (\text{Im}(\lambda))^2 \leq 1\\
    0 \; \; \;\text{ otherwise}.
  \end{cases}
\]</span></p>
<p>This result can be used to calculate the radius of the eigenvalue distribution of the matrices studied by May: when the off-diagonal coefficients <span class="math inline">\(M_{ij}\)</span> are 0 with probability <span class="math inline">\(1-C\)</span> and are sampled independently from a distribution with mean <span class="math inline">\(0\)</span> and variance <span class="math inline">\(\sigma^2\)</span> with probability <span class="math inline">\(C\)</span>, we have that <span class="math inline">\(\mathbb E[M_{ij}] = 0\)</span> and <span class="math inline">\(\mathbb E[M_{ij}^2] = C \sigma^2\)</span>. This means that if we were to divide the coefficients of <span class="math inline">\({M}\)</span> by <span class="math inline">\(\sqrt{C \sigma^2}\)</span> we would recover the unit variance, and the matrix would follow the circular law when <span class="math inline">\(S\)</span> is large. Armed with this, we can calculate the radius: if the radius of <span class="math inline">\({M} / \sqrt{S C \sigma^2}\)</span> converges to 1 when the matrix is large, then the radius of <span class="math inline">\({M}\)</span> is approximately <span class="math inline">\(\sqrt{S C \sigma^2}\)</span>. For stability, we need a sufficiently negative diagonal, yielding May’s stability criterion:</p>
<p><span class="math display">\[
\sqrt{S C \sigma^2} &lt; d
\]</span></p>
<p>We can try this on our matrix:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="intro.html#cb17-1"></a>prediction &lt;-<span class="st"> </span><span class="kw">sqrt</span>(n <span class="op">*</span><span class="st"> </span>C <span class="op">*</span><span class="st"> </span>sigma<span class="op">^</span><span class="dv">2</span>) <span class="op">-</span><span class="st"> </span>d</span>
<span id="cb17-2"><a href="intro.html#cb17-2"></a><span class="kw">plot_eigenvalues</span>(M, prediction)</span></code></pre></div>
<p><img src="A-tour-of-the-Generalized-Lotka-Volterra-Model_files/figure-html/unnamed-chunk-11-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Showing that we accurately approximate the location of the rightmost eigenvalue. Note that, in the case of large <span class="math inline">\(n\)</span>, whenever the circle crosses zero, some eigenvalues will be positive, determining the instability of the equilibrium.</p>
<p>Importantly, the distribution from which the coefficients are sampled does not matter—only that the mean is zero and that the variance is <span class="math inline">\(\sigma^2\)</span>. For example, build the matrix using coefficients from a uniform distribution:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="intro.html#cb18-1"></a>build_May_uniform &lt;-<span class="st"> </span><span class="cf">function</span>(n, C, d, sigma){</span>
<span id="cb18-2"><a href="intro.html#cb18-2"></a>  <span class="co"># fill the whole matrix (sqrt(3) to ensure var = sigma^2)</span></span>
<span id="cb18-3"><a href="intro.html#cb18-3"></a>  M &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">runif</span>(n <span class="op">*</span><span class="st"> </span>n, <span class="dt">min =</span> <span class="op">-</span><span class="kw">sqrt</span>(<span class="dv">3</span>) <span class="op">*</span><span class="st"> </span>sigma, <span class="dt">max =</span> <span class="kw">sqrt</span>(<span class="dv">3</span>) <span class="op">*</span><span class="st"> </span>sigma), n, n)</span>
<span id="cb18-4"><a href="intro.html#cb18-4"></a>  <span class="co"># remove connections </span></span>
<span id="cb18-5"><a href="intro.html#cb18-5"></a>  M &lt;-<span class="st"> </span>M <span class="op">*</span><span class="st"> </span><span class="kw">matrix</span>(<span class="kw">runif</span>(n <span class="op">*</span><span class="st"> </span>n) <span class="op">&lt;=</span><span class="st"> </span>C, n, n)</span>
<span id="cb18-6"><a href="intro.html#cb18-6"></a>  <span class="co"># set diagonals</span></span>
<span id="cb18-7"><a href="intro.html#cb18-7"></a>  <span class="kw">diag</span>(M) &lt;-<span class="st"> </span><span class="op">-</span>d</span>
<span id="cb18-8"><a href="intro.html#cb18-8"></a>  <span class="kw">return</span>(M)</span>
<span id="cb18-9"><a href="intro.html#cb18-9"></a>}</span>
<span id="cb18-10"><a href="intro.html#cb18-10"></a><span class="co"># parameters</span></span>
<span id="cb18-11"><a href="intro.html#cb18-11"></a>n &lt;-<span class="st"> </span><span class="dv">500</span></span>
<span id="cb18-12"><a href="intro.html#cb18-12"></a>C &lt;-<span class="st"> </span><span class="fl">0.5</span></span>
<span id="cb18-13"><a href="intro.html#cb18-13"></a>d &lt;-<span class="st"> </span><span class="dv">10</span></span>
<span id="cb18-14"><a href="intro.html#cb18-14"></a>sigma &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb18-15"><a href="intro.html#cb18-15"></a>M &lt;-<span class="st"> </span><span class="kw">build_May_uniform</span>(n, C, d, sigma)</span>
<span id="cb18-16"><a href="intro.html#cb18-16"></a>prediction &lt;-<span class="st"> </span><span class="kw">sqrt</span>(n <span class="op">*</span><span class="st"> </span>C <span class="op">*</span><span class="st"> </span>sigma<span class="op">^</span><span class="dv">2</span>) <span class="op">-</span><span class="st"> </span>d</span>
<span id="cb18-17"><a href="intro.html#cb18-17"></a><span class="kw">plot_eigenvalues</span>(M, prediction)</span></code></pre></div>
<p><img src="A-tour-of-the-Generalized-Lotka-Volterra-Model_files/figure-html/unnamed-chunk-12-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>This property is called <strong>universality</strong> in random matrix theory.</p>
<p>In ecological communities, the effect of species <span class="math inline">\(i\)</span> on <span class="math inline">\(j\)</span> and that of <span class="math inline">\(j\)</span> on <span class="math inline">\(i\)</span> are typically not independent (as assumed above): in the case of competition between species, we expect them both to be negative; for consumption, if one is positive, the other is negative, and so forth. A more refined model of a random matrix would therefore sample interactions in pairs from a bivariate distribution. The elliptic law can deal with this case:</p>
<p><strong>Elliptic law:</strong> Take a non-symmetric, <span class="math inline">\(S \times S\)</span> random matrix in which the pairs of coefficients <span class="math inline">\((X_{ij}, X_{ji})\)</span> are sampled independently from a bivariate distribution defined by a vector of means <span class="math inline">\(m = (0,0)^t\)</span> and a covariance matrix <span class="math inline">\(\Sigma = \begin{pmatrix} 1 &amp; \rho\\ \rho &amp; 1 \end{pmatrix}\)</span>. Then, as <span class="math inline">\(S \to \infty\)</span>, the e.s.d. of <span class="math inline">\({X} / \sqrt{S}\)</span> converges to the elliptic law:</p>
<p><span class="math display">\[
  \mu(\lambda) = \begin{cases} \frac{1}{\pi (1 - \rho^2) } \quad
    \text{if} \; \frac{(\text{Re}(\lambda))^2}{(1 + \rho)^2} +
    \frac{(\text{Im}(\lambda))^2}{(1 -\rho)^2} \leq
    1\\ 0 \quad \quad \quad \text{ otherwise}
  \end{cases}
\]</span></p>
<p>Note that when <span class="math inline">\(\rho = 0\)</span>, the elliptic law reduces to the circular law. Using the elliptic law, <span class="citation">Allesina and Tang (<a href="#ref-allesina2012stability" role="doc-biblioref">2012</a>)</span> were able to extend May’s criterion to ecological networks with different mixtures of interaction types. In particular, the stability criterion becomes:</p>
<p><span class="math display">\[
\sqrt{S C \sigma^2}(1 + \rho) &lt; d
\]</span></p>
<p>To see the elliptic law in action, we can build matrices in which we sample the coefficients in pairs from a bivariate normal distribution:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="intro.html#cb19-1"></a>build_Allesina_Tang_normal &lt;-<span class="st"> </span><span class="cf">function</span>(n, C, d, sigma, rho){</span>
<span id="cb19-2"><a href="intro.html#cb19-2"></a>  <span class="co"># sample coefficients in pairs</span></span>
<span id="cb19-3"><a href="intro.html#cb19-3"></a>  pairs &lt;-<span class="st"> </span>MASS<span class="op">::</span><span class="kw">mvrnorm</span>(<span class="dt">n =</span> n <span class="op">*</span><span class="st"> </span>(n<span class="dv">-1</span>) <span class="op">/</span><span class="st"> </span><span class="dv">2</span>,</span>
<span id="cb19-4"><a href="intro.html#cb19-4"></a>                         <span class="dt">mu =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb19-5"><a href="intro.html#cb19-5"></a>                         <span class="dt">Sigma =</span> sigma<span class="op">^</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>, rho, rho, <span class="dv">1</span>), <span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb19-6"><a href="intro.html#cb19-6"></a>  <span class="co"># build a completely filled matrix</span></span>
<span id="cb19-7"><a href="intro.html#cb19-7"></a>  M &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, n, n)</span>
<span id="cb19-8"><a href="intro.html#cb19-8"></a>  M[<span class="kw">upper.tri</span>(M)] &lt;-<span class="st"> </span>pairs[,<span class="dv">1</span>]</span>
<span id="cb19-9"><a href="intro.html#cb19-9"></a>  M &lt;-<span class="st"> </span><span class="kw">t</span>(M)</span>
<span id="cb19-10"><a href="intro.html#cb19-10"></a>  M[<span class="kw">upper.tri</span>(M)] &lt;-<span class="st"> </span>pairs[,<span class="dv">2</span>]</span>
<span id="cb19-11"><a href="intro.html#cb19-11"></a>  <span class="co"># determine which connections to retain</span></span>
<span id="cb19-12"><a href="intro.html#cb19-12"></a>  Connections &lt;-<span class="st"> </span>(<span class="kw">matrix</span>(<span class="kw">runif</span>(n <span class="op">*</span><span class="st"> </span>n), n, n) <span class="op">&lt;=</span><span class="st"> </span>C) <span class="op">*</span><span class="st"> </span><span class="dv">1</span> </span>
<span id="cb19-13"><a href="intro.html#cb19-13"></a>  Connections[<span class="kw">lower.tri</span>(Connections)] &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb19-14"><a href="intro.html#cb19-14"></a>  <span class="kw">diag</span>(Connections) &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb19-15"><a href="intro.html#cb19-15"></a>  Connections &lt;-<span class="st"> </span>Connections <span class="op">+</span><span class="st"> </span><span class="kw">t</span>(Connections)</span>
<span id="cb19-16"><a href="intro.html#cb19-16"></a>  M &lt;-<span class="st"> </span>M <span class="op">*</span><span class="st"> </span>Connections</span>
<span id="cb19-17"><a href="intro.html#cb19-17"></a>  <span class="kw">diag</span>(M) &lt;-<span class="st"> </span><span class="op">-</span>d</span>
<span id="cb19-18"><a href="intro.html#cb19-18"></a>  <span class="kw">return</span>(M)</span>
<span id="cb19-19"><a href="intro.html#cb19-19"></a>}</span></code></pre></div>
<p>We can see that a positive connectance leads to an eigenvalue distribution that describes an horizontally-stretched ellipse (and hence, more difficult to stabilize than the circle):</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="intro.html#cb20-1"></a><span class="co"># parameters</span></span>
<span id="cb20-2"><a href="intro.html#cb20-2"></a>n &lt;-<span class="st"> </span><span class="dv">500</span></span>
<span id="cb20-3"><a href="intro.html#cb20-3"></a>C &lt;-<span class="st"> </span><span class="fl">0.5</span></span>
<span id="cb20-4"><a href="intro.html#cb20-4"></a>d &lt;-<span class="st"> </span><span class="dv">10</span></span>
<span id="cb20-5"><a href="intro.html#cb20-5"></a>sigma &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb20-6"><a href="intro.html#cb20-6"></a>rho &lt;-<span class="st"> </span><span class="fl">0.4</span></span>
<span id="cb20-7"><a href="intro.html#cb20-7"></a>M &lt;-<span class="st"> </span><span class="kw">build_Allesina_Tang_normal</span>(n, C, d, sigma, rho)</span>
<span id="cb20-8"><a href="intro.html#cb20-8"></a>prediction &lt;-<span class="st"> </span><span class="kw">sqrt</span>(n <span class="op">*</span><span class="st"> </span>C <span class="op">*</span><span class="st"> </span>sigma<span class="op">^</span><span class="dv">2</span>) <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>rho) <span class="op">-</span><span class="st"> </span>d</span>
<span id="cb20-9"><a href="intro.html#cb20-9"></a><span class="kw">plot_eigenvalues</span>(M, prediction)</span></code></pre></div>
<p><img src="A-tour-of-the-Generalized-Lotka-Volterra-Model_files/figure-html/unnamed-chunk-14-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Similarly, a negative correlation (e.g., as in predator-prey) would make the system easier to stabilize:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="intro.html#cb21-1"></a><span class="co"># parameters</span></span>
<span id="cb21-2"><a href="intro.html#cb21-2"></a>n &lt;-<span class="st"> </span><span class="dv">500</span></span>
<span id="cb21-3"><a href="intro.html#cb21-3"></a>C &lt;-<span class="st"> </span><span class="fl">0.5</span></span>
<span id="cb21-4"><a href="intro.html#cb21-4"></a>d &lt;-<span class="st"> </span><span class="dv">10</span></span>
<span id="cb21-5"><a href="intro.html#cb21-5"></a>sigma &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb21-6"><a href="intro.html#cb21-6"></a>rho &lt;-<span class="st"> </span><span class="fl">-0.4</span></span>
<span id="cb21-7"><a href="intro.html#cb21-7"></a>M &lt;-<span class="st"> </span><span class="kw">build_Allesina_Tang_normal</span>(n, C, d, sigma, rho)</span>
<span id="cb21-8"><a href="intro.html#cb21-8"></a>prediction &lt;-<span class="st"> </span><span class="kw">sqrt</span>(n <span class="op">*</span><span class="st"> </span>C <span class="op">*</span><span class="st"> </span>sigma<span class="op">^</span><span class="dv">2</span>) <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>rho) <span class="op">-</span><span class="st"> </span>d</span>
<span id="cb21-9"><a href="intro.html#cb21-9"></a><span class="kw">plot_eigenvalues</span>(M, prediction)</span></code></pre></div>
<p><img src="A-tour-of-the-Generalized-Lotka-Volterra-Model_files/figure-html/unnamed-chunk-15-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="further-readings" class="section level2">
<h2><span class="header-section-number">2.8</span> Further readings</h2>
<p>On the theory of GLV:</p>
<p>On random matrices and stability:</p>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-allesina2012stability">
<p>Allesina, Stefano, and Si Tang. 2012. “Stability Criteria for Complex Ecosystems.” <em>Nature</em> 483 (7388): 205.</p>
</div>
<div id="ref-barabas2016effect">
<p>Barabás, György, Matthew J. Michalska-Smith, and Stefano Allesina. 2016. “The Effect of Intra-and Interspecific Competition on Coexistence in Multispecies Communities.” <em>The American Naturalist</em> 188 (1): E1–E12.</p>
</div>
<div id="ref-hirsch1982systems">
<p>Hirsch, Morris W. 1982. “Systems of Differential Equations Which Are Competitive or Cooperative: I. Limit Sets.” <em>SIAM Journal on Mathematical Analysis</em> 13 (2): 167–79.</p>
</div>
<div id="ref-may1972will">
<p>May, Robert M. 1972. “Will a Large Complex System Be Stable?” <em>Nature</em> 238 (5364): 413–14.</p>
</div>
<div id="ref-smale1976differential">
<p>Smale, Steve. 1976. “On the Differential Equations of Species in Competition.” <em>Journal of Mathematical Biology</em> 3 (1): 5–7.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="multi.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["A tour of the Generalized Lotka-Volterra Model.pdf", "A tour of the Generalized Lotka-Volterra Model.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
