<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4 Evolutionary Game Theory | A Tour of the Generalized Lotka-Volterra Model</title>
  <meta name="description" content="Lectures for the ICTP-SAIFR/IFT-UNESP School on Community Ecology: from patterns to principles" />
  <meta name="generator" content="bookdown 0.16 and GitBook 2.6.7" />

  <meta property="og:title" content="4 Evolutionary Game Theory | A Tour of the Generalized Lotka-Volterra Model" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Lectures for the ICTP-SAIFR/IFT-UNESP School on Community Ecology: from patterns to principles" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4 Evolutionary Game Theory | A Tour of the Generalized Lotka-Volterra Model" />
  
  <meta name="twitter:description" content="Lectures for the ICTP-SAIFR/IFT-UNESP School on Community Ecology: from patterns to principles" />
  

<meta name="author" content="Stefano Allesina" />


<meta name="date" content="2019-12-30" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="multi.html"/>
<link rel="next" href="data.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Lectures on Lotka-Volterra</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#prerequisites"><i class="fa fa-check"></i><b>1.1</b> Prerequisites</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#sources"><i class="fa fa-check"></i><b>1.2</b> Sources</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Generalized Lotka-Volterra</a><ul>
<li class="chapter" data-level="2.1" data-path="intro.html"><a href="intro.html#history"><i class="fa fa-check"></i><b>2.1</b> History</a><ul>
<li class="chapter" data-level="2.1.1" data-path="intro.html"><a href="intro.html#lotka-volterra-interactions"><i class="fa fa-check"></i><b>2.1.1</b> Lotka-Volterra interactions</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="intro.html"><a href="intro.html#basic-formulation"><i class="fa fa-check"></i><b>2.2</b> Basic formulation</a></li>
<li class="chapter" data-level="2.3" data-path="intro.html"><a href="intro.html#a-single-population"><i class="fa fa-check"></i><b>2.3</b> A single population</a><ul>
<li class="chapter" data-level="2.3.1" data-path="intro.html"><a href="intro.html#metapopulation-dynamics"><i class="fa fa-check"></i><b>2.3.1</b> Metapopulation dynamics</a></li>
<li class="chapter" data-level="2.3.2" data-path="intro.html"><a href="intro.html#s-i-s-model"><i class="fa fa-check"></i><b>2.3.2</b> S-I-S model</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="intro.html"><a href="intro.html#multi-species-dynamics"><i class="fa fa-check"></i><b>2.4</b> Multi-species dynamics</a><ul>
<li class="chapter" data-level="2.4.1" data-path="intro.html"><a href="intro.html#existence-of-an-equilibrium"><i class="fa fa-check"></i><b>2.4.1</b> Existence of an equilibrium</a></li>
<li class="chapter" data-level="2.4.2" data-path="intro.html"><a href="intro.html#stability-of-an-equilibrium"><i class="fa fa-check"></i><b>2.4.2</b> Stability of an equilibrium</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="intro.html"><a href="intro.html#types-of-dynamics"><i class="fa fa-check"></i><b>2.5</b> Types of dynamics</a></li>
<li class="chapter" data-level="2.6" data-path="intro.html"><a href="intro.html#the-equilibrium-is-the-time-average"><i class="fa fa-check"></i><b>2.6</b> The equilibrium is the time-average</a></li>
<li class="chapter" data-level="2.7" data-path="intro.html"><a href="intro.html#d-stability-and-lyapunov-function"><i class="fa fa-check"></i><b>2.7</b> D-stability and Lyapunov function</a></li>
<li class="chapter" data-level="2.8" data-path="intro.html"><a href="intro.html#stability-of-large-random-communities"><i class="fa fa-check"></i><b>2.8</b> Stability of large random communities</a></li>
<li class="chapter" data-level="2.9" data-path="intro.html"><a href="intro.html#further-readings"><i class="fa fa-check"></i><b>2.9</b> Further readings</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="multi.html"><a href="multi.html"><i class="fa fa-check"></i><b>3</b> Multispecies GLV</a><ul>
<li class="chapter" data-level="3.1" data-path="multi.html"><a href="multi.html#feasibility"><i class="fa fa-check"></i><b>3.1</b> Feasibility</a></li>
<li class="chapter" data-level="3.2" data-path="multi.html"><a href="multi.html#stability"><i class="fa fa-check"></i><b>3.2</b> Stability</a></li>
<li class="chapter" data-level="3.3" data-path="multi.html"><a href="multi.html#non-invasibility"><i class="fa fa-check"></i><b>3.3</b> Non-invasibility</a></li>
<li class="chapter" data-level="3.4" data-path="multi.html"><a href="multi.html#assembly"><i class="fa fa-check"></i><b>3.4</b> Assembly</a></li>
<li class="chapter" data-level="3.5" data-path="multi.html"><a href="multi.html#a-random-zoo"><i class="fa fa-check"></i><b>3.5</b> A random zoo</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="games.html"><a href="games.html"><i class="fa fa-check"></i><b>4</b> Evolutionary Game Theory</a><ul>
<li class="chapter" data-level="4.1" data-path="games.html"><a href="games.html#game-theory"><i class="fa fa-check"></i><b>4.1</b> Game theory</a></li>
<li class="chapter" data-level="4.2" data-path="games.html"><a href="games.html#two-player-matrix-games"><i class="fa fa-check"></i><b>4.2</b> Two-player matrix games</a><ul>
<li class="chapter" data-level="4.2.1" data-path="games.html"><a href="games.html#example-the-prisoners-dilemma"><i class="fa fa-check"></i><b>4.2.1</b> Example: the prisoner’s dilemma</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="games.html"><a href="games.html#mixed-strategies"><i class="fa fa-check"></i><b>4.3</b> Mixed strategies</a></li>
<li class="chapter" data-level="4.4" data-path="games.html"><a href="games.html#nash-equilibria"><i class="fa fa-check"></i><b>4.4</b> Nash Equilibria</a></li>
<li class="chapter" data-level="4.5" data-path="games.html"><a href="games.html#evolutionary-stable-strategies"><i class="fa fa-check"></i><b>4.5</b> Evolutionary stable strategies</a></li>
<li class="chapter" data-level="4.6" data-path="games.html"><a href="games.html#replicator-dynamics"><i class="fa fa-check"></i><b>4.6</b> Replicator dynamics</a><ul>
<li class="chapter" data-level="4.6.1" data-path="games.html"><a href="games.html#invariants"><i class="fa fa-check"></i><b>4.6.1</b> Invariants</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="games.html"><a href="games.html#equivalence-with-glv"><i class="fa fa-check"></i><b>4.7</b> Equivalence with GLV</a><ul>
<li class="chapter" data-level="4.7.1" data-path="games.html"><a href="games.html#rock-paper-scissor"><i class="fa fa-check"></i><b>4.7.1</b> Rock-paper-scissor</a></li>
<li class="chapter" data-level="4.7.2" data-path="games.html"><a href="games.html#hypertournament-games"><i class="fa fa-check"></i><b>4.7.2</b> Hypertournament games</a></li>
<li class="chapter" data-level="4.7.3" data-path="games.html"><a href="games.html#lyapunov-function"><i class="fa fa-check"></i><b>4.7.3</b> Lyapunov function</a></li>
<li class="chapter" data-level="4.7.4" data-path="games.html"><a href="games.html#higher-order-interactions"><i class="fa fa-check"></i><b>4.7.4</b> Higher-order interactions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="data.html"><a href="data.html"><i class="fa fa-check"></i><b>5</b> Simple models for synthetic communities</a><ul>
<li class="chapter" data-level="5.1" data-path="data.html"><a href="data.html#synthetic-communities-using-the-glv-model"><i class="fa fa-check"></i><b>5.1</b> Synthetic communities using the GLV model</a></li>
<li class="chapter" data-level="5.2" data-path="data.html"><a href="data.html#total-biomass"><i class="fa fa-check"></i><b>5.2</b> Total biomass</a></li>
<li class="chapter" data-level="5.3" data-path="data.html"><a href="data.html#hyperplanes"><i class="fa fa-check"></i><b>5.3</b> Hyperplanes</a></li>
<li class="chapter" data-level="5.4" data-path="data.html"><a href="data.html#fitting-real-data"><i class="fa fa-check"></i><b>5.4</b> Fitting real data</a></li>
<li class="chapter" data-level="5.5" data-path="data.html"><a href="data.html#predicting-real-data-out-of-fit"><i class="fa fa-check"></i><b>5.5</b> Predicting real data out of fit</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">A Tour of the Generalized Lotka-Volterra Model</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="games" class="section level1">
<h1><span class="header-section-number">4</span> Evolutionary Game Theory</h1>
<div id="game-theory" class="section level2">
<h2><span class="header-section-number">4.1</span> Game theory</h2>
<p>We briefly introduce the study of mathematical models of games, and their relations to the GLV model. While the origin of game theory can be traced back to the 1700s, modern game theory started with von Neumann’s paper <em>On the Theory of Games of Strategy</em>, published in 1928, and with the subsequent 1944 book with Morgensten <em>Theory of Games and Economic Behavior</em>. John Nash’s paper <span class="citation">(Nash and others <a href="#ref-nash1950equilibrium" role="doc-biblioref">1950</a>)</span> introduced the notion of a <strong>Nash Equilibrium</strong> (NE). Originally, game theory was studied by economists and mathematicians, but with the 1973 book <em>Evolution and the Theory of Games</em> <span class="citation">(Smith <a href="#ref-smith1982evolution" role="doc-biblioref">1982</a>)</span>, John Maynard Smith showed how the same tools could be used to study evolutionary dynamics, introducing the influential concept of an <strong>Evolutionary Stable Strategy</strong> (ESS). Evolutionary game theory was greatly advanced through the introduction of the <strong>Replicator Equation</strong> (RE), which, as we will see later, has strong connection with the GLV model. For a detailaed introduction to evolutionary game theory see <span class="citation">Hofbauer and Sigmund (<a href="#ref-hofbauer1998evolutionary" role="doc-biblioref">1998</a>)</span>.</p>
</div>
<div id="two-player-matrix-games" class="section level2">
<h2><span class="header-section-number">4.2</span> Two-player matrix games</h2>
<p>We start by anayzing games in which two players face each other, each choosing one strategy out of a set. Importantly, we consider static games in which each player makes their decision without having knowledge of the decision of the other player. Player 1 chooses a “pure” strategy <span class="math inline">\(s_1\)</span> from the set of pure strategies <span class="math inline">\(S_1\)</span>, while player 2 chooses <span class="math inline">\(s_2 \in S_2\)</span>. We call <span class="math inline">\(\pi_k (s_1, s_2)\)</span> the <strong>payoff</strong> for player <span class="math inline">\(k\)</span> when player 1 chooses <span class="math inline">\(s_1\)</span> and player 2 <span class="math inline">\(s_2\)</span>. In a matrix game, we can arrange the payoffs for each player in a matrix. We call <span class="math inline">\(A\)</span> the matrix of payoffs for player one and <span class="math inline">\(B\)</span> that for player 2.</p>
<div id="example-the-prisoners-dilemma" class="section level3">
<h3><span class="header-section-number">4.2.1</span> Example: the prisoner’s dilemma</h3>
<p>Two prisoners alleggedly committed a crime, but the police do not have enough evidence to convict them. They therefore approach each player separately, proposing a deal: if the prisoner confesses (“defect” the other prisoner), then their sentence will be reduced. In particular: i) if both confess (both “defect”), they are sentenced to 4 years in prison; ii) if one confesses (“defect”) and the other keeps quiet (“cooperate” with the other prisoner), then the one who has confessed is let free, and the other sentenced to 5 years; iii) if both keep quiet (“cooperate”), then they are both sentenced to two years of detention.</p>
<p>In matrix form, we have (rows for pl 1 strategy C/D; cols for pl 2 strategy):</p>
<p><span class="math display">\[
A = \begin{pmatrix}
-2 &amp; -5\\
0 &amp; -4
\end{pmatrix} \quad
B = \begin{pmatrix}
-2 &amp; -5\\
0 &amp; -4
\end{pmatrix}
\]</span></p>
<p>What is the best strategy player 1 can play, without knowing whether player 2 will confess or not? If player 2 were to keep quiet, player 1 should confess and be let free; if player 2 confesses, on the other hand, player 1 should also confess and get a reduced sentence. As such, each player would rationally choose to confess, thereby getting sentenced to four years in prison; note that if they could trust the other player, they could cooperate to get a much reduced sentence.</p>
</div>
</div>
<div id="mixed-strategies" class="section level2">
<h2><span class="header-section-number">4.3</span> Mixed strategies</h2>
<p>Above, the player could choose one out of two strategies. A generalization of this situation is one in which players play <strong>mixed</strong> strategies, i.e., play a given strategy at random according to a set of probabilities. Call <span class="math inline">\(x_i\)</span> the probability that player 1 plays strategy <span class="math inline">\(i\)</span>; then <span class="math inline">\(\sum_i x_i = 1\)</span>. Similarly, <span class="math inline">\(y_i\)</span> is the probability that player 2 plays strategy <span class="math inline">\(i\)</span>. A natural choice for the payoff of player 1 is therefore:</p>
<p><span class="math display">\[
\sum_{i=1}^m \sum_{j = 1}^n x_i y_j \pi_1 (s_1, s_2) = x^t A y
\]</span>
Similarly, we have <span class="math inline">\(y^t B x\)</span> for player 2.</p>
<p>A mixed strategy <span class="math inline">\(x\)</span> is dominated by mixed strategy <span class="math inline">\(\tilde{x}\)</span> if <span class="math inline">\(\tilde{x}^t A y \geq x A y\)</span> for every <span class="math inline">\(y\)</span>. The condition can be written as <span class="math inline">\((\tilde{x}^t - x) A y \geq 0\)</span>.</p>
</div>
<div id="nash-equilibria" class="section level2">
<h2><span class="header-section-number">4.4</span> Nash Equilibria</h2>
<p>A pair of mixed strategies <span class="math inline">\(\tilde{x}\)</span> and <span class="math inline">\(\tilde{y}\)</span> is called a Nash Equilibrium for a two person matrix game if:</p>
<p><span class="math display">\[
\begin{aligned}
\tilde{x}^t A \tilde{y} \geq x^t A \tilde{y} &amp;\quad \text{for all } x\\
\tilde{y}^t B \tilde{x} \geq y^t B \tilde{x} &amp;\quad \text{for all } y
\end{aligned}
\]</span></p>
<p>Nash proved that every two-person game has at least one Nash Equilibrium.</p>
</div>
<div id="evolutionary-stable-strategies" class="section level2">
<h2><span class="header-section-number">4.5</span> Evolutionary stable strategies</h2>
<p>In the context of evolution, one can consider <span class="math inline">\(x\)</span> to be the proportion of individuals (e.g., of different species, or phenotypes) displaying different characteristics. When playing against each other, they win or lose, and their payoffs are invested in reproduction. Because the different “strategies” (populations, phenotypes) play against each other, the payoff matrix is the same for all players, and encoded in matrix <span class="math inline">\(A\)</span>.</p>
<p>In this context, a strategy <span class="math inline">\(x\)</span> is called an evolutionary stable strategy if two conditions are met:
<span class="math display">\[
x^t A x \geq y^t A x \quad \text{for all } y
\]</span>
meaning that <span class="math inline">\(x\)</span> plays against itself not worse than any other strategy, and</p>
<p><span class="math display">\[
\text{If } y \neq x \text{ then } y^t A x = x^t A x \text{ implies } x^t A y &gt; y^t A y
\]</span></p>
<p>meaning that if <span class="math inline">\(y\)</span> plays as well as <span class="math inline">\(x\)</span> against <span class="math inline">\(x\)</span>, then <span class="math inline">\(x\)</span> plays against <span class="math inline">\(y\)</span> better than <span class="math inline">\(y\)</span> against itself.</p>
<p>We next connect NE and ESS with dynamical systems.</p>
</div>
<div id="replicator-dynamics" class="section level2">
<h2><span class="header-section-number">4.6</span> Replicator dynamics</h2>
<p>The replicator equation can be written as:</p>
<p><span class="math display">\[
\dfrac{d x}{dt} = D(x)(A x - x^t A x)
\]</span></p>
<p>Where <span class="math inline">\(f = A x\)</span> is a vector reporting the fitness of each population at time <span class="math inline">\(t\)</span>, and <span class="math inline">\(\bar{f} = x^t A t\)</span> is the average fitness at time <span class="math inline">\(t\)</span>. As such, one can write the replicator equation more compactly as:</p>
<p><span class="math display">\[
\dfrac{d x_i}{dt} = x_i (f_i - \bar{f})
\]</span></p>
<p>The RE is essentially equivalent to a GLV model in which we track frequencies instead of abundances.</p>
<div id="invariants" class="section level3">
<h3><span class="header-section-number">4.6.1</span> Invariants</h3>
<p>Adding a constant to each column of <span class="math inline">\(A\)</span> does not alter the dynamics. We have <span class="math inline">\(B = A + e b^t\)</span>, where <span class="math inline">\(e\)</span> is a vector of ones. Then:</p>
<p><span class="math display">\[
\begin{aligned}
D(x)(B x - x^t B x) &amp;= D(x)(A + eb^t) x - x^t (A + eb^t) x\\
&amp;= D(x)A x + D(x) eb^t x - x^t A x - x^t e b^t x\\
&amp;= D(x)A x + x^t e b^t x - x^t A x - x^t e b^t  x\\
&amp;= D(x)A - x^t A x\\
&amp;= D(x)(A x - x^t A x)
\end{aligned}
\]</span></p>
<p>Similarly, multiplying each column of <span class="math inline">\(A\)</span> by a (possibly different) positive constant does not alter dynamics (it just rescales time). As such, if <span class="math inline">\(A_2 = A_1 D + eb^t\)</span> the replicator equations formed using <span class="math inline">\(A_1\)</span> and <span class="math inline">\(A_2\)</span> are equivalent.</p>
</div>
</div>
<div id="equivalence-with-glv" class="section level2">
<h2><span class="header-section-number">4.7</span> Equivalence with GLV</h2>
<p>TODO</p>
<div id="rock-paper-scissor" class="section level3">
<h3><span class="header-section-number">4.7.1</span> Rock-paper-scissor</h3>
<p>Let’s try our hand with a simple zero-sum (i.e., <span class="math inline">\(A = -A^t\)</span>) replicator equation. We have three populations (“rock”, “paper”, and “scissors”) with payoff matrix:</p>
<p><span class="math display">\[
A = \begin{pmatrix}
0 &amp; -1 &amp; 1\\
1 &amp; 0 &amp; -1\\
-1 &amp; 1 &amp; 0
\end{pmatrix}
\]</span></p>
<p>We start the population at a random initial condition, and track dynamics:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="games.html#cb25-1"></a><span class="kw">library</span>(deSolve) <span class="co"># integrate ODEs</span></span>
<span id="cb25-2"><a href="games.html#cb25-2"></a><span class="kw">library</span>(tidyverse) <span class="co"># plotting and wrangling</span></span>
<span id="cb25-3"><a href="games.html#cb25-3"></a><span class="co"># define the differential equation</span></span>
<span id="cb25-4"><a href="games.html#cb25-4"></a>RE &lt;-<span class="cf">function</span>(t, x, parameters){</span>
<span id="cb25-5"><a href="games.html#cb25-5"></a>  <span class="kw">with</span>(<span class="kw">as.list</span>(<span class="kw">c</span>(x, parameters)), {</span>
<span id="cb25-6"><a href="games.html#cb25-6"></a>    x[x <span class="op">&lt;</span><span class="st"> </span><span class="dv">10</span><span class="op">^-</span><span class="dv">8</span>] &lt;-<span class="st"> </span><span class="dv">0</span> <span class="co"># prevent numerical problems</span></span>
<span id="cb25-7"><a href="games.html#cb25-7"></a>    x &lt;-<span class="st"> </span>x <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(x) <span class="co"># keep on simplex</span></span>
<span id="cb25-8"><a href="games.html#cb25-8"></a>    dxdt &lt;-<span class="st"> </span>x <span class="op">*</span><span class="st"> </span>(A <span class="op">%*%</span><span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="kw">sum</span>(x <span class="op">*</span><span class="st"> </span>A <span class="op">%*%</span><span class="st"> </span>x))</span>
<span id="cb25-9"><a href="games.html#cb25-9"></a>    <span class="kw">list</span>(dxdt)</span>
<span id="cb25-10"><a href="games.html#cb25-10"></a>  })</span>
<span id="cb25-11"><a href="games.html#cb25-11"></a>}</span>
<span id="cb25-12"><a href="games.html#cb25-12"></a><span class="co"># function to plot output</span></span>
<span id="cb25-13"><a href="games.html#cb25-13"></a>plot_ODE_output &lt;-<span class="st"> </span><span class="cf">function</span>(out){</span>
<span id="cb25-14"><a href="games.html#cb25-14"></a>  out &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(out)</span>
<span id="cb25-15"><a href="games.html#cb25-15"></a>  <span class="kw">colnames</span>(out) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;time&quot;</span>, <span class="kw">paste</span>(<span class="st">&quot;sp&quot;</span>, <span class="dv">1</span><span class="op">:</span>(<span class="kw">ncol</span>(out) <span class="dv">-1</span>), <span class="dt">sep =</span> <span class="st">&quot;_&quot;</span>))</span>
<span id="cb25-16"><a href="games.html#cb25-16"></a>  out &lt;-<span class="st"> </span><span class="kw">as_tibble</span>(out) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">gather</span>(species, density, <span class="op">-</span>time)</span>
<span id="cb25-17"><a href="games.html#cb25-17"></a>  pl &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> out) <span class="op">+</span><span class="st"> </span></span>
<span id="cb25-18"><a href="games.html#cb25-18"></a><span class="st">    </span><span class="kw">aes</span>(<span class="dt">x =</span> time, <span class="dt">y =</span> density, <span class="dt">colour =</span> species) <span class="op">+</span><span class="st"> </span></span>
<span id="cb25-19"><a href="games.html#cb25-19"></a><span class="st">    </span><span class="kw">geom_line</span>()</span>
<span id="cb25-20"><a href="games.html#cb25-20"></a>  <span class="kw">show</span>(pl)</span>
<span id="cb25-21"><a href="games.html#cb25-21"></a>  <span class="kw">return</span>(out)</span>
<span id="cb25-22"><a href="games.html#cb25-22"></a>}</span>
<span id="cb25-23"><a href="games.html#cb25-23"></a><span class="co"># general function to integrate GLV</span></span>
<span id="cb25-24"><a href="games.html#cb25-24"></a>integrate_RE &lt;-<span class="st"> </span><span class="cf">function</span>(A, x0, <span class="dt">maxtime =</span> <span class="dv">40</span>, <span class="dt">steptime =</span> <span class="fl">0.05</span>){</span>
<span id="cb25-25"><a href="games.html#cb25-25"></a>  times &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, maxtime, <span class="dt">by =</span> steptime)</span>
<span id="cb25-26"><a href="games.html#cb25-26"></a>  parameters &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">A =</span> A)</span>
<span id="cb25-27"><a href="games.html#cb25-27"></a>  <span class="co"># solve numerically</span></span>
<span id="cb25-28"><a href="games.html#cb25-28"></a>  out &lt;-<span class="st"> </span><span class="kw">ode</span>(<span class="dt">y =</span> x0, <span class="dt">times =</span> times, </span>
<span id="cb25-29"><a href="games.html#cb25-29"></a>           <span class="dt">func =</span> RE, <span class="dt">parms =</span> parameters, </span>
<span id="cb25-30"><a href="games.html#cb25-30"></a>           <span class="dt">method =</span> <span class="st">&quot;ode45&quot;</span>)</span>
<span id="cb25-31"><a href="games.html#cb25-31"></a>  <span class="co"># plot and make into tidy form</span></span>
<span id="cb25-32"><a href="games.html#cb25-32"></a>  out &lt;-<span class="st"> </span><span class="kw">plot_ODE_output</span>(out)</span>
<span id="cb25-33"><a href="games.html#cb25-33"></a>  <span class="kw">return</span>(out)</span>
<span id="cb25-34"><a href="games.html#cb25-34"></a>}</span>
<span id="cb25-35"><a href="games.html#cb25-35"></a><span class="co"># payoff matrix</span></span>
<span id="cb25-36"><a href="games.html#cb25-36"></a>A &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">-1</span>, <span class="dv">1</span>,</span>
<span id="cb25-37"><a href="games.html#cb25-37"></a>              <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">-1</span>,</span>
<span id="cb25-38"><a href="games.html#cb25-38"></a>              <span class="dv">-1</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="dv">3</span>, <span class="dv">3</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>)</span>
<span id="cb25-39"><a href="games.html#cb25-39"></a><span class="co"># initial conditions</span></span>
<span id="cb25-40"><a href="games.html#cb25-40"></a>x0 &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">3</span>)</span>
<span id="cb25-41"><a href="games.html#cb25-41"></a>x0 &lt;-<span class="st"> </span>x0 <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(x0)</span>
<span id="cb25-42"><a href="games.html#cb25-42"></a>rps &lt;-<span class="st"> </span><span class="kw">integrate_RE</span>(A, x0)</span></code></pre></div>
<p><img src="A-Tour-of-the-Generalized-Lotka-Volterra-Model_files/figure-html/refuctions-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>What if we start all populations at the same density?</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="games.html#cb26-1"></a>x0 &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span><span class="dv">3</span>, <span class="dv">3</span>)</span>
<span id="cb26-2"><a href="games.html#cb26-2"></a>rps &lt;-<span class="st"> </span><span class="kw">integrate_RE</span>(A, x0)</span></code></pre></div>
<p><img src="A-Tour-of-the-Generalized-Lotka-Volterra-Model_files/figure-html/rps2-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>And if they are close to the 1/3?</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="games.html#cb27-1"></a>x0 &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">3</span>, <span class="dv">3</span>) <span class="op">+</span><span class="st"> </span><span class="fl">0.05</span> <span class="op">*</span><span class="st"> </span><span class="kw">runif</span>(<span class="dv">3</span>)</span>
<span id="cb27-2"><a href="games.html#cb27-2"></a>x0 &lt;-<span class="st"> </span>x0 <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(x0)</span>
<span id="cb27-3"><a href="games.html#cb27-3"></a>rps &lt;-<span class="st"> </span><span class="kw">integrate_RE</span>(A, x0)</span></code></pre></div>
<p><img src="A-Tour-of-the-Generalized-Lotka-Volterra-Model_files/figure-html/rps3-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="hypertournament-games" class="section level3">
<h3><span class="header-section-number">4.7.2</span> Hypertournament games</h3>
<p>The rock-paper-scissor game above is a simple case of a hypertournament game. Take the zero-sum payoff matrix <span class="math inline">\(A = -A^t\)</span>. Then, we have</p>
<p><span class="math display">\[
\sum_i \sum_j A_{ij} x_i x_j = 0
\]</span>
and the RE simplifies to</p>
<p><span class="math display">\[
\dfrac{d x}{dt} = D(x) A x
\]</span></p>
<p>At equilibrium, either some elements of <span class="math inline">\(x\)</span> are zero, or</p>
<p><span class="math display">\[
A x^\star = 0
\]</span>
meaning that <span class="math inline">\(x^\star\)</span> is an eigenvector of <span class="math inline">\(A\)</span> corresponding to a zero eigenvalue.</p>
<div id="number-of-coexisting-species" class="section level4">
<h4><span class="header-section-number">4.7.2.1</span> Number of coexisting species</h4>
<p>Suppose that an habitat is composed of a large number of patches, each containing a single individual (e.g., a tropical rainforest). Individuals die at a certain rate <span class="math inline">\(d = 1\)</span>, and whenever they produce offspring, they disperse it to the empty patches. Whenever two individuals land in the same patch, they compete. The coefficient <span class="math inline">\(H_{ij}\)</span> corresponds to the probability of <span class="math inline">\(i\)</span> winning when competing with <span class="math inline">\(j\)</span>, and we have <span class="math inline">\(H_{ij} + H_{ji} = 1\)</span>. For each empty patch, we sample two seeds (produced at a rate proportional to <span class="math inline">\(x_i\)</span>) and compete them. Dynamics become <span class="citation">(Grilli et al. <a href="#ref-grilli2017higher" role="doc-biblioref">2017</a>)</span>:</p>
<p><span class="math display">\[
\begin{aligned}
  \dfrac{d x}{dt} &amp;= x_i \left(\sum_j 2 H_{ij} x_j - 1 \right) \\
  &amp;=x_i \sum_j (2 H_{ij} x_j - x_j) \\
  &amp;= x_i \sum_j (H_{ij} x_j  + (1 - H_{ji}) x_j - x_j) \\
  &amp;= x_i \sum_j (H_{ij} - H_{ji}) x_j \\
  &amp;= x_i  \sum_j A_{ij} x_j
\end{aligned}
\]</span></p>
<p>I.e., we recover the RE for a zero-sum game. What happens if we draw <span class="math inline">\(H\)</span> (and therefore <span class="math inline">\(A\)</span>) at random? <span class="citation">Allesina and Levine (<a href="#ref-allesina2011competitive" role="doc-biblioref">2011</a>)</span> and <span class="citation">Grilli et al. (<a href="#ref-grilli2017higher" role="doc-biblioref">2017</a>)</span> applied the results of <span class="citation">Fisher and Reeves (<a href="#ref-fisher1995optimal" role="doc-biblioref">1995</a>)</span> and <span class="citation">Brandl (<a href="#ref-brandl2017distribution" role="doc-biblioref">2017</a>)</span> to show that, when <span class="math inline">\(n\)</span> species compete, the probability of observing <span class="math inline">\(k\)</span> coexisting is <span class="math inline">\(p(k|n) = \binom{n}{k} 2^{1-n}\)</span> when <span class="math inline">\(k\)</span> is odd, and <span class="math inline">\(p(k|n) = 0\)</span> when <span class="math inline">\(k\)</span> is even.</p>
<p>Importantly, to find the set of coexisting species we do not need to integrate dynamics. One can use linear programming to solve for the set of species that will coexist.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="games.html#cb28-1"></a><span class="kw">library</span>(lpSolve)</span>
<span id="cb28-2"><a href="games.html#cb28-2"></a><span class="co"># Build a random matrix H such that H_ij + H_ji = 1</span></span>
<span id="cb28-3"><a href="games.html#cb28-3"></a>random_H &lt;-<span class="st"> </span><span class="cf">function</span>(n){</span>
<span id="cb28-4"><a href="games.html#cb28-4"></a>  <span class="co"># build random hypertournament H</span></span>
<span id="cb28-5"><a href="games.html#cb28-5"></a>  H &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">runif</span>(n <span class="op">*</span><span class="st"> </span>n), n, n)</span>
<span id="cb28-6"><a href="games.html#cb28-6"></a>  <span class="kw">return</span>(H <span class="op">/</span><span class="st"> </span>(H <span class="op">+</span><span class="st"> </span><span class="kw">t</span>(H)))</span>
<span id="cb28-7"><a href="games.html#cb28-7"></a>}</span>
<span id="cb28-8"><a href="games.html#cb28-8"></a><span class="co"># Find the optimal strategy for the two-person game encoded in H</span></span>
<span id="cb28-9"><a href="games.html#cb28-9"></a><span class="co"># using linear programming.</span></span>
<span id="cb28-10"><a href="games.html#cb28-10"></a><span class="co"># This is also the coexistence equilibrium of the dynamical system.</span></span>
<span id="cb28-11"><a href="games.html#cb28-11"></a>find_optimal_strategy &lt;-<span class="st"> </span><span class="cf">function</span>(H){</span>
<span id="cb28-12"><a href="games.html#cb28-12"></a>  n &lt;-<span class="st"> </span><span class="kw">dim</span>(H)[<span class="dv">1</span>]</span>
<span id="cb28-13"><a href="games.html#cb28-13"></a>  f.obj &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">1</span>, n)</span>
<span id="cb28-14"><a href="games.html#cb28-14"></a>  f.con &lt;-<span class="st"> </span>H</span>
<span id="cb28-15"><a href="games.html#cb28-15"></a>  f.rhs &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">1</span>, n)</span>
<span id="cb28-16"><a href="games.html#cb28-16"></a>  f.dir &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="st">&quot;&lt;=&quot;</span>, n)</span>
<span id="cb28-17"><a href="games.html#cb28-17"></a>  z &lt;-<span class="st"> </span><span class="kw">lp</span> (<span class="st">&quot;max&quot;</span>, f.obj, f.con, f.dir, f.rhs)</span>
<span id="cb28-18"><a href="games.html#cb28-18"></a>  <span class="kw">return</span>(z<span class="op">$</span>solution <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(z<span class="op">$</span>solution))</span>
<span id="cb28-19"><a href="games.html#cb28-19"></a>}</span></code></pre></div>
<p>Now let’s try to count how many species suvive when starting with 10:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="games.html#cb29-1"></a>n &lt;-<span class="st"> </span><span class="dv">10</span></span>
<span id="cb29-2"><a href="games.html#cb29-2"></a>num_simulations &lt;-<span class="st"> </span><span class="dv">5000</span></span>
<span id="cb29-3"><a href="games.html#cb29-3"></a>results &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">simulation =</span> <span class="dv">1</span><span class="op">:</span>num_simulations, <span class="dt">coexisting =</span> <span class="ot">NA</span>)</span>
<span id="cb29-4"><a href="games.html#cb29-4"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>num_simulations){</span>
<span id="cb29-5"><a href="games.html#cb29-5"></a>  H &lt;-<span class="st"> </span><span class="kw">random_H</span>(n)</span>
<span id="cb29-6"><a href="games.html#cb29-6"></a>  coexisting &lt;-<span class="st"> </span><span class="kw">find_optimal_strategy</span>(H)</span>
<span id="cb29-7"><a href="games.html#cb29-7"></a>  results[i,<span class="st">&quot;coexisting&quot;</span>] &lt;-<span class="st"> </span><span class="kw">sum</span>(coexisting <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>)</span>
<span id="cb29-8"><a href="games.html#cb29-8"></a>}</span>
<span id="cb29-9"><a href="games.html#cb29-9"></a><span class="co"># and plot</span></span>
<span id="cb29-10"><a href="games.html#cb29-10"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> results) <span class="op">+</span><span class="st"> </span><span class="kw">aes</span>(<span class="dt">x =</span> coexisting) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>() <span class="op">+</span><span class="st"> </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">10</span>)</span></code></pre></div>
<p><img src="A-Tour-of-the-Generalized-Lotka-Volterra-Model_files/figure-html/coexistlphist-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="lyapunov-function" class="section level3">
<h3><span class="header-section-number">4.7.3</span> Lyapunov function</h3>
<p>In the rock-paper-scissor example above, the species cycled neutrally around the single equilibrium point. To show that this is in fact the behavior of this type of RE, we write a Lyapunov function. By finding a constant of motion we can show that the species will follow closed orbits.</p>
<p>Suppose <span class="math inline">\(x_{i}^\star &gt; 0\)</span> is the equilibrium for the system. We write:</p>
<p><span class="math display">\[
V(x) = -\sum_i x_i^\ast \log \frac{x_i}{x_i^\ast} .
\]</span></p>
<p>Because of Gibbs’ inequality, <span class="math inline">\(V(x) \geq 0\)</span> for any <span class="math inline">\(x\)</span>, and is equal to zero only if <span class="math inline">\(x = x^\star\)</span>. Note also that at equilibrium <span class="math inline">\(2 \sum_j H_{ij} x_j^\star = 1\)</span>. We write:</p>
<p><span class="math display">\[
\begin{aligned}
  \dfrac{d V}{d t} &amp;= \sum_i \dfrac{\partial V}{\partial x_i}
  \dfrac{d x_i}{d t}\\
  &amp;= - \sum_i \frac{x_i^\star}{x_i} \dfrac{d x_i}{d t} \\
  &amp;= -2 \sum_{i,j} x_i^\star H_{ij}x_j + \sum_i x_i^\star\\
  &amp;= -2 \sum_{i,j} x_i^\star H_{ij}x_j + 1\\
  &amp;= \sum_j \left(-2 \sum_i H_{ij}x_i^\star \right) x_j + 1\\
  &amp;= \sum_j \left(-2 \sum_i (1 - H_{ji}) x_i^\star \right) x_j + 1\\
  &amp;= \sum_j \left(-2 \sum_i x_i^\star + 2 \sum_i H_{ji} x_i^\star \right) x_j
  + 1 \\
  &amp;= \sum_j \left(-2 + 1 \right) x_j  + 1 \\
  &amp;=- \sum_j x_j + 1\\
  &amp;= 0 
\end{aligned}
\]</span></p>
<p>We have found a constant of motion, meaning that the system will follow closed orbits. Hence, unless we start the system precisely at <span class="math inline">\(x^\ast\)</span>, the abundances will cycle neutrally around the equilibrium.</p>
<p>Let’s try with a larger system:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="games.html#cb30-1"></a>n &lt;-<span class="st"> </span><span class="dv">5</span></span>
<span id="cb30-2"><a href="games.html#cb30-2"></a><span class="co"># search for random H yielding all species coexisting</span></span>
<span id="cb30-3"><a href="games.html#cb30-3"></a>i &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb30-4"><a href="games.html#cb30-4"></a><span class="cf">while</span>(<span class="ot">TRUE</span>){</span>
<span id="cb30-5"><a href="games.html#cb30-5"></a>  i &lt;-<span class="st"> </span>i <span class="op">+</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb30-6"><a href="games.html#cb30-6"></a>  <span class="kw">set.seed</span>(i)</span>
<span id="cb30-7"><a href="games.html#cb30-7"></a>  H &lt;-<span class="st"> </span><span class="kw">random_H</span>(n)</span>
<span id="cb30-8"><a href="games.html#cb30-8"></a>  x_star &lt;-<span class="st"> </span><span class="kw">find_optimal_strategy</span>(H)</span>
<span id="cb30-9"><a href="games.html#cb30-9"></a>  <span class="cf">if</span> (<span class="kw">all</span>(x_star) <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) <span class="cf">break</span></span>
<span id="cb30-10"><a href="games.html#cb30-10"></a>}</span>
<span id="cb30-11"><a href="games.html#cb30-11"></a><span class="co"># payoff matrix</span></span>
<span id="cb30-12"><a href="games.html#cb30-12"></a>A &lt;-<span class="st"> </span>H <span class="op">-</span><span class="st"> </span><span class="kw">t</span>(H)</span>
<span id="cb30-13"><a href="games.html#cb30-13"></a><span class="co"># initial conditions close to equilibrium</span></span>
<span id="cb30-14"><a href="games.html#cb30-14"></a>x0 &lt;-<span class="st"> </span>x_star <span class="op">+</span><span class="st"> </span><span class="kw">runif</span>(n) <span class="op">*</span><span class="st"> </span><span class="fl">0.2</span></span>
<span id="cb30-15"><a href="games.html#cb30-15"></a>x0 &lt;-<span class="st"> </span>x0 <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(x0)</span>
<span id="cb30-16"><a href="games.html#cb30-16"></a>fivespp &lt;-<span class="st"> </span><span class="kw">integrate_RE</span>(A, x0, <span class="dt">maxtime =</span> <span class="dv">400</span>, <span class="dt">steptime =</span> <span class="fl">0.1</span>)</span></code></pre></div>
<p><img src="A-Tour-of-the-Generalized-Lotka-Volterra-Model_files/figure-html/reneutral-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="higher-order-interactions" class="section level3">
<h3><span class="header-section-number">4.7.4</span> Higher-order interactions</h3>
<p>We can extend the game above to the case in which three (or more) individuals compete in each patch. <span class="citation">Grilli et al. (<a href="#ref-grilli2017higher" role="doc-biblioref">2017</a>)</span> showed that in this case, one can write the replicator equation:</p>
<p><span class="math display">\[
\dfrac{d x_i}{dt} = x_i \sum_{j,k} A_{ijk} x_j x_k
\]</span>
where the tensor <span class="math inline">\(A\)</span> (a three-dimensional matrix) encodes the effect of a pair of species (<span class="math inline">\(j\)</span> and <span class="math inline">\(k\)</span>) on the density of <span class="math inline">\(i\)</span>. Importantly, one can choose the tensor such that the equilibrium is the same as for the two-player replicator equation: take <span class="math inline">\(A_{ijk} = 2 H_{ij} H_{ik} - H_{ji} H_{jk} - H_{ki} H_{kj}\)</span>, which can be derived from first principles by writing the stochastic dynamics. What is surprising is that, while the equilibrium is unchanged, the dynamics are now globally stable:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="games.html#cb31-1"></a><span class="co"># Now payoff is a tensor</span></span>
<span id="cb31-2"><a href="games.html#cb31-2"></a>RE_<span class="dv">3</span> &lt;-<span class="st"> </span><span class="cf">function</span>(t, x, parameters){</span>
<span id="cb31-3"><a href="games.html#cb31-3"></a>  <span class="kw">with</span>(<span class="kw">as.list</span>(<span class="kw">c</span>(x, parameters)), {</span>
<span id="cb31-4"><a href="games.html#cb31-4"></a>    x[x <span class="op">&lt;</span><span class="st"> </span><span class="dv">10</span><span class="op">^-</span><span class="dv">8</span>] &lt;-<span class="st"> </span><span class="dv">0</span> <span class="co"># prevent numerical problems</span></span>
<span id="cb31-5"><a href="games.html#cb31-5"></a>    x &lt;-<span class="st"> </span>x <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(x) <span class="co"># keep on simplex</span></span>
<span id="cb31-6"><a href="games.html#cb31-6"></a>    n &lt;-<span class="st"> </span><span class="kw">length</span>(x)</span>
<span id="cb31-7"><a href="games.html#cb31-7"></a>    dxidt &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, n)</span>
<span id="cb31-8"><a href="games.html#cb31-8"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</span>
<span id="cb31-9"><a href="games.html#cb31-9"></a>      dxidt[i] &lt;-<span class="st"> </span>x[i] <span class="op">*</span><span class="st"> </span>x <span class="op">%*%</span><span class="st"> </span>P3[i,,] <span class="op">%*%</span><span class="st"> </span>x</span>
<span id="cb31-10"><a href="games.html#cb31-10"></a>    }</span>
<span id="cb31-11"><a href="games.html#cb31-11"></a>    <span class="kw">list</span>(dxidt)</span>
<span id="cb31-12"><a href="games.html#cb31-12"></a>  })</span>
<span id="cb31-13"><a href="games.html#cb31-13"></a>}</span>
<span id="cb31-14"><a href="games.html#cb31-14"></a><span class="co"># general function to integrate RE_3</span></span>
<span id="cb31-15"><a href="games.html#cb31-15"></a>integrate_RE_<span class="dv">3</span> &lt;-<span class="st"> </span><span class="cf">function</span>(H, x0, <span class="dt">maxtime =</span> <span class="dv">40</span>, <span class="dt">steptime =</span> <span class="fl">0.05</span>){</span>
<span id="cb31-16"><a href="games.html#cb31-16"></a>  times &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, maxtime, <span class="dt">by =</span> steptime)</span>
<span id="cb31-17"><a href="games.html#cb31-17"></a>  n &lt;-<span class="st"> </span><span class="kw">nrow</span>(H)</span>
<span id="cb31-18"><a href="games.html#cb31-18"></a>  P3 &lt;-<span class="st"> </span><span class="kw">array</span>(<span class="dv">0</span>, <span class="kw">c</span>(n, n, n))</span>
<span id="cb31-19"><a href="games.html#cb31-19"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</span>
<span id="cb31-20"><a href="games.html#cb31-20"></a>    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</span>
<span id="cb31-21"><a href="games.html#cb31-21"></a>      <span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</span>
<span id="cb31-22"><a href="games.html#cb31-22"></a>        P3[i,j,k] &lt;-<span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>H[i,j] <span class="op">*</span><span class="st"> </span>H[i,k] <span class="op">-</span><span class="st">  </span>H[j,i] <span class="op">*</span><span class="st"> </span>H[j,k] <span class="op">-</span><span class="st"> </span>H[k,i] <span class="op">*</span><span class="st"> </span>H[k,j]</span>
<span id="cb31-23"><a href="games.html#cb31-23"></a>      }</span>
<span id="cb31-24"><a href="games.html#cb31-24"></a>    }</span>
<span id="cb31-25"><a href="games.html#cb31-25"></a>  }</span>
<span id="cb31-26"><a href="games.html#cb31-26"></a>  parameters &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">P3 =</span> P3)</span>
<span id="cb31-27"><a href="games.html#cb31-27"></a>  <span class="co"># solve numerically</span></span>
<span id="cb31-28"><a href="games.html#cb31-28"></a>  out &lt;-<span class="st"> </span><span class="kw">ode</span>(<span class="dt">y =</span> x0, <span class="dt">times =</span> times, </span>
<span id="cb31-29"><a href="games.html#cb31-29"></a>           <span class="dt">func =</span> RE_<span class="dv">3</span>, <span class="dt">parms =</span> parameters, </span>
<span id="cb31-30"><a href="games.html#cb31-30"></a>           <span class="dt">method =</span> <span class="st">&quot;ode45&quot;</span>)</span>
<span id="cb31-31"><a href="games.html#cb31-31"></a>  <span class="co"># plot and make into tidy form</span></span>
<span id="cb31-32"><a href="games.html#cb31-32"></a>  out &lt;-<span class="st"> </span><span class="kw">plot_ODE_output</span>(out)</span>
<span id="cb31-33"><a href="games.html#cb31-33"></a>  <span class="kw">return</span>(out)</span>
<span id="cb31-34"><a href="games.html#cb31-34"></a>}</span>
<span id="cb31-35"><a href="games.html#cb31-35"></a><span class="co"># integrate the system above</span></span>
<span id="cb31-36"><a href="games.html#cb31-36"></a>fivespp &lt;-<span class="st"> </span><span class="kw">integrate_RE_3</span>(H, x0, <span class="dt">maxtime =</span> <span class="dv">800</span>, <span class="dt">steptime =</span> <span class="fl">0.1</span>)</span></code></pre></div>
<p><img src="A-Tour-of-the-Generalized-Lotka-Volterra-Model_files/figure-html/rehoi-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>And the rock-paper-scissors:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="games.html#cb32-1"></a>H &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">0</span>,</span>
<span id="cb32-2"><a href="games.html#cb32-2"></a>              <span class="dv">0</span>, <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>, <span class="dv">1</span>,</span>
<span id="cb32-3"><a href="games.html#cb32-3"></a>              <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>), <span class="dv">3</span>, <span class="dv">3</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>)</span>
<span id="cb32-4"><a href="games.html#cb32-4"></a>x0 &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">3</span>)</span>
<span id="cb32-5"><a href="games.html#cb32-5"></a>x0 &lt;-<span class="st"> </span>x0 <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(x0)</span>
<span id="cb32-6"><a href="games.html#cb32-6"></a>rps &lt;-<span class="st"> </span><span class="kw">integrate_RE_3</span>(H, x0, <span class="dt">maxtime =</span> <span class="dv">50</span>, <span class="dt">steptime =</span> <span class="fl">0.1</span>)</span></code></pre></div>
<p><img src="A-Tour-of-the-Generalized-Lotka-Volterra-Model_files/figure-html/rpshoi-1.png" width="672" style="display: block; margin: auto;" /></p>

</div>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-allesina2011competitive">
<p>Allesina, Stefano, and Jonathan M Levine. 2011. “A Competitive Network Theory of Species Diversity.” <em>Proceedings of the National Academy of Sciences</em> 108 (14): 5638–42.</p>
</div>
<div id="ref-brandl2017distribution">
<p>Brandl, Florian. 2017. “The Distribution of Optimal Strategies in Symmetric Zero-Sum Games.” <em>Games and Economic Behavior</em> 104: 674–80.</p>
</div>
<div id="ref-fisher1995optimal">
<p>Fisher, David C, and Richard B Reeves. 1995. “Optimal Strategies for Random Tournament Games.” <em>Linear Algebra and Its Applications</em> 217: 83–85.</p>
</div>
<div id="ref-grilli2017higher">
<p>Grilli, Jacopo, György Barabás, Matthew J Michalska-Smith, and Stefano Allesina. 2017. “Higher-Order Interactions Stabilize Dynamics in Competitive Network Models.” <em>Nature</em> 548 (7666): 210.</p>
</div>
<div id="ref-hofbauer1998evolutionary">
<p>Hofbauer, Josef, and Karl Sigmund. 1998. <em>Evolutionary Games and Population Dynamics</em>. Cambridge university press.</p>
</div>
<div id="ref-nash1950equilibrium">
<p>Nash, John F, and others. 1950. “Equilibrium Points in N-Person Games.” <em>Proceedings of the National Academy of Sciences</em> 36 (1): 48–49.</p>
</div>
<div id="ref-smith1982evolution">
<p>Smith, John Maynard. 1982. <em>Evolution and the Theory of Games</em>. Cambridge university press.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="multi.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="data.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["A Tour of the Generalized Lotka-Volterra Model.pdf"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
