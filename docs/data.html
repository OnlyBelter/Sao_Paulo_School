<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5 Simple models for synthetic communities | A Tour of the Generalized Lotka-Volterra Model</title>
  <meta name="description" content="Lectures for the ICTP-SAIFR/IFT-UNESP School on Community Ecology: from patterns to principles" />
  <meta name="generator" content="bookdown 0.16 and GitBook 2.6.7" />

  <meta property="og:title" content="5 Simple models for synthetic communities | A Tour of the Generalized Lotka-Volterra Model" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Lectures for the ICTP-SAIFR/IFT-UNESP School on Community Ecology: from patterns to principles" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5 Simple models for synthetic communities | A Tour of the Generalized Lotka-Volterra Model" />
  
  <meta name="twitter:description" content="Lectures for the ICTP-SAIFR/IFT-UNESP School on Community Ecology: from patterns to principles" />
  

<meta name="author" content="Stefano Allesina" />


<meta name="date" content="2020-01-09" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="games.html"/>
<link rel="next" href="references.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Lectures on Lotka-Volterra</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#prerequisites"><i class="fa fa-check"></i><b>1.1</b> Prerequisites</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#sources"><i class="fa fa-check"></i><b>1.2</b> Sources</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Generalized Lotka-Volterra</a><ul>
<li class="chapter" data-level="2.1" data-path="intro.html"><a href="intro.html#history"><i class="fa fa-check"></i><b>2.1</b> History</a><ul>
<li class="chapter" data-level="2.1.1" data-path="intro.html"><a href="intro.html#lotka-volterra-interactions"><i class="fa fa-check"></i><b>2.1.1</b> Lotka-Volterra interactions</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="intro.html"><a href="intro.html#basic-formulation"><i class="fa fa-check"></i><b>2.2</b> Basic formulation</a></li>
<li class="chapter" data-level="2.3" data-path="intro.html"><a href="intro.html#a-single-population"><i class="fa fa-check"></i><b>2.3</b> A single population</a><ul>
<li class="chapter" data-level="2.3.1" data-path="intro.html"><a href="intro.html#metapopulation-dynamics"><i class="fa fa-check"></i><b>2.3.1</b> Metapopulation dynamics</a></li>
<li class="chapter" data-level="2.3.2" data-path="intro.html"><a href="intro.html#s-i-s-model"><i class="fa fa-check"></i><b>2.3.2</b> S-I-S model</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="intro.html"><a href="intro.html#multi-species-dynamics"><i class="fa fa-check"></i><b>2.4</b> Multi-species dynamics</a><ul>
<li class="chapter" data-level="2.4.1" data-path="intro.html"><a href="intro.html#existence-of-an-equilibrium"><i class="fa fa-check"></i><b>2.4.1</b> Existence of an equilibrium</a></li>
<li class="chapter" data-level="2.4.2" data-path="intro.html"><a href="intro.html#stability-of-an-equilibrium"><i class="fa fa-check"></i><b>2.4.2</b> Stability of an equilibrium</a></li>
<li class="chapter" data-level="2.4.3" data-path="intro.html"><a href="intro.html#types-of-dynamics"><i class="fa fa-check"></i><b>2.4.3</b> Types of dynamics</a></li>
<li class="chapter" data-level="2.4.4" data-path="intro.html"><a href="intro.html#the-equilibrium-is-the-time-average"><i class="fa fa-check"></i><b>2.4.4</b> The equilibrium is the time-average</a></li>
<li class="chapter" data-level="2.4.5" data-path="intro.html"><a href="intro.html#lyapunov-diagonal-stability-and-global-stability"><i class="fa fa-check"></i><b>2.4.5</b> Lyapunov diagonal stability and global stability</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="intro.html"><a href="intro.html#stability-of-large-random-communities"><i class="fa fa-check"></i><b>2.5</b> Stability of large random communities</a></li>
<li class="chapter" data-level="2.6" data-path="intro.html"><a href="intro.html#further-readings"><i class="fa fa-check"></i><b>2.6</b> Further readings</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="multi.html"><a href="multi.html"><i class="fa fa-check"></i><b>3</b> Multispecies GLV: assembly and invasibility</a><ul>
<li class="chapter" data-level="3.1" data-path="multi.html"><a href="multi.html#assembly"><i class="fa fa-check"></i><b>3.1</b> Assembly</a></li>
<li class="chapter" data-level="3.2" data-path="multi.html"><a href="multi.html#invasion-in-multispecies-communities"><i class="fa fa-check"></i><b>3.2</b> Invasion in multispecies communities</a></li>
<li class="chapter" data-level="3.3" data-path="multi.html"><a href="multi.html#lyapunov-stability-and-saturated-equilibria"><i class="fa fa-check"></i><b>3.3</b> Lyapunov stability and saturated equilibria</a></li>
<li class="chapter" data-level="3.4" data-path="multi.html"><a href="multi.html#how-many-species-will-coexist"><i class="fa fa-check"></i><b>3.4</b> How many species will coexist?</a><ul>
<li class="chapter" data-level="3.4.1" data-path="multi.html"><a href="multi.html#a-trivial-case"><i class="fa fa-check"></i><b>3.4.1</b> A trivial case</a></li>
<li class="chapter" data-level="3.4.2" data-path="multi.html"><a href="multi.html#simulating-final-composition"><i class="fa fa-check"></i><b>3.4.2</b> Simulating final composition</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="multi.html"><a href="multi.html#a-random-zoo"><i class="fa fa-check"></i><b>3.5</b> A random zoo</a></li>
<li class="chapter" data-level="3.6" data-path="multi.html"><a href="multi.html#assembly-and-saturated-equilibrium"><i class="fa fa-check"></i><b>3.6</b> Assembly and saturated equilibrium</a></li>
<li class="chapter" data-level="3.7" data-path="multi.html"><a href="multi.html#network-spandrels"><i class="fa fa-check"></i><b>3.7</b> Network spandrels</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="games.html"><a href="games.html"><i class="fa fa-check"></i><b>4</b> Evolutionary Game Theory</a><ul>
<li class="chapter" data-level="4.1" data-path="games.html"><a href="games.html#game-theory"><i class="fa fa-check"></i><b>4.1</b> Game theory</a></li>
<li class="chapter" data-level="4.2" data-path="games.html"><a href="games.html#two-player-matrix-games"><i class="fa fa-check"></i><b>4.2</b> Two-player matrix games</a><ul>
<li class="chapter" data-level="4.2.1" data-path="games.html"><a href="games.html#example-the-prisoners-dilemma"><i class="fa fa-check"></i><b>4.2.1</b> Example: the prisoner’s dilemma</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="games.html"><a href="games.html#mixed-strategies"><i class="fa fa-check"></i><b>4.3</b> Mixed strategies</a></li>
<li class="chapter" data-level="4.4" data-path="games.html"><a href="games.html#nash-equilibria"><i class="fa fa-check"></i><b>4.4</b> Nash Equilibria</a></li>
<li class="chapter" data-level="4.5" data-path="games.html"><a href="games.html#evolutionary-stable-strategies"><i class="fa fa-check"></i><b>4.5</b> Evolutionary stable strategies</a></li>
<li class="chapter" data-level="4.6" data-path="games.html"><a href="games.html#replicator-dynamics"><i class="fa fa-check"></i><b>4.6</b> Replicator dynamics</a><ul>
<li class="chapter" data-level="4.6.1" data-path="games.html"><a href="games.html#invariants"><i class="fa fa-check"></i><b>4.6.1</b> Invariants</a></li>
<li class="chapter" data-level="4.6.2" data-path="games.html"><a href="games.html#rock-paper-scissor"><i class="fa fa-check"></i><b>4.6.2</b> Rock-paper-scissor</a></li>
<li class="chapter" data-level="4.6.3" data-path="games.html"><a href="games.html#equivalence-with-glv"><i class="fa fa-check"></i><b>4.6.3</b> Equivalence with GLV</a></li>
<li class="chapter" data-level="4.6.4" data-path="games.html"><a href="games.html#hypertournament-games"><i class="fa fa-check"></i><b>4.6.4</b> Hypertournament games</a></li>
<li class="chapter" data-level="4.6.5" data-path="games.html"><a href="games.html#lyapunov-function"><i class="fa fa-check"></i><b>4.6.5</b> Lyapunov function</a></li>
<li class="chapter" data-level="4.6.6" data-path="games.html"><a href="games.html#higher-order-interactions"><i class="fa fa-check"></i><b>4.6.6</b> Higher-order interactions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="data.html"><a href="data.html"><i class="fa fa-check"></i><b>5</b> Simple models for synthetic communities</a><ul>
<li class="chapter" data-level="5.1" data-path="data.html"><a href="data.html#synthetic-communities-using-the-glv-model"><i class="fa fa-check"></i><b>5.1</b> Synthetic communities using the GLV model</a></li>
<li class="chapter" data-level="5.2" data-path="data.html"><a href="data.html#total-biomass"><i class="fa fa-check"></i><b>5.2</b> Total biomass</a></li>
<li class="chapter" data-level="5.3" data-path="data.html"><a href="data.html#hyperplanes"><i class="fa fa-check"></i><b>5.3</b> Hyperplanes</a></li>
<li class="chapter" data-level="5.4" data-path="data.html"><a href="data.html#fitting-real-data"><i class="fa fa-check"></i><b>5.4</b> Fitting real data</a></li>
<li class="chapter" data-level="5.5" data-path="data.html"><a href="data.html#predicting-real-data-out-of-fit"><i class="fa fa-check"></i><b>5.5</b> Predicting real data out of fit</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">A Tour of the Generalized Lotka-Volterra Model</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="data" class="section level1">
<h1><span class="header-section-number">5</span> Simple models for synthetic communities</h1>
<p>Ecologists have performed large experiments in which different assemblages of species are co-cultured. These experiments have been conducted with plants (for example, Biodiversity Ecosystem Functioning experiments e.g., <span class="citation">(Hector et al. <a href="#ref-hector1999plant" role="doc-biblioref">1999</a>)</span> <span class="citation">(Tilman et al. <a href="#ref-tilman2001diversity" role="doc-biblioref">2001</a>)</span> <span class="citation">(Cadotte <a href="#ref-cadotte2013experimental" role="doc-biblioref">2013</a>)</span>) and in the laboratory using protozoan, algae or bacteria. Two commonly-encountered problems in this type of experiments have to to with the scaling of the number of experiments with the number of species, and with the probability of coexistence.</p>
<p><strong>Scale:</strong> How many communities can we form from a pool of <span class="math inline">\(n\)</span> species? We can culture a single species in isolation (<span class="math inline">\(n\)</span> possibilities), two species in pair (<span class="math inline">\(n(n-1) / 2\)</span> possibilities), and so on. The total is therefore:</p>
<p><span class="math display">\[
\sum_{j=1}^n \binom{n}{j} = 2^n -1
\]</span></p>
<p>And this is only considering the presence/absence of each species! Moreover, we might want to vary the initial conditions (e.g., starting two species at low/high abundance, equal abundance, high/low abundace), etc. Clearly, this makes trying all possible combinations unfeasible when <span class="math inline">\(n\)</span> is large enough. For example, for 10 species we can form 1023 assemblages, while with 20 more than a million!</p>
<p><strong>Coexistence:</strong> even if we could try all possible experiments, many assemblages would collapse to smaller communities because of extinctions. For example, pairs could become monocultures, triplets become pairs or monocultures, etc. As such, even if we were to try all possible combinations, we would end up observing a smaller set of “final communities”.</p>
<p>To solve these two issues, we would need to find a good way to navigate the enormous space of possibilities, thereby suggesting “good” experiments that yield a large probability of coexistence.</p>
<div id="synthetic-communities-using-the-glv-model" class="section level2">
<h2><span class="header-section-number">5.1</span> Synthetic communities using the GLV model</h2>
<p>To set the stage for deriving a statistical model that can deal with the problems above, we start by simulating the communities that can be formed from a pool of <span class="math inline">\(n\)</span> species using the GLV model. First, we need a way to index our communities. We take a vector <span class="math inline">\(p\)</span> reporting the presence/absence of a given species at the beginning of the experiment. We then associate a label <span class="math inline">\(k \in \{1, \ldots, 2^n -1\}\)</span> with the experiment. This label uniquely defines the composition of a community. If only taxon 1 is present (<span class="math inline">\(p = [1,0,0,\ldots,0]\)</span>), then <span class="math inline">\(k = 1\)</span>, if only taxon 2 is present (<span class="math inline">\(p =[0,1,0,\ldots,0]\)</span>) then <span class="math inline">\(k = 2\)</span>, if both taxa 1 and 2 are part of the experiment, <span class="math inline">\(k = 3\)</span> (<span class="math inline">\(p = [1,1,0,\ldots,0]\)</span>); in general, <span class="math inline">\(k = \sum_{i = 1}^n p_i 2^{(i-1)}\)</span> where <span class="math inline">\(p_i = 1\)</span> if taxon <span class="math inline">\(i\)</span> is part of the experiment, and <span class="math inline">\(p_i = 0\)</span> otherwise.</p>
<p>We can then cycle through each of the <span class="math inline">\(2^n - 1\)</span> assemblages that can be formed, and determine whether the species will coexist or not in our experiment. For simplicity, we report as coexisting any set of species for which a) the GLV equilibrium is feasible, and b) it is locally stable. We collect all the communities that are coexisting along with the abundance of all species in the matrix <span class="math inline">\(E\)</span>.</p>
<p>In <code>R</code>:</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="data.html#cb75-1"></a><span class="kw">set.seed</span>(<span class="dv">3</span>)</span>
<span id="cb75-2"><a href="data.html#cb75-2"></a><span class="co"># take a random matrix of interactions: </span></span>
<span id="cb75-3"><a href="data.html#cb75-3"></a><span class="co"># -Aij &lt;- U[0,1]; -Aii &lt;- Sqrt(2) + U[0,1]</span></span>
<span id="cb75-4"><a href="data.html#cb75-4"></a><span class="co"># all interactions are competitive</span></span>
<span id="cb75-5"><a href="data.html#cb75-5"></a>n &lt;-<span class="st"> </span><span class="dv">5</span></span>
<span id="cb75-6"><a href="data.html#cb75-6"></a>A &lt;-<span class="st"> </span><span class="op">-</span><span class="kw">matrix</span>(<span class="kw">runif</span>(n <span class="op">*</span><span class="st"> </span>n), n, n)</span>
<span id="cb75-7"><a href="data.html#cb75-7"></a><span class="kw">diag</span>(A) &lt;-<span class="st"> </span><span class="kw">diag</span>(A) <span class="op">-</span><span class="st"> </span><span class="kw">sqrt</span>(<span class="dv">2</span>)</span>
<span id="cb75-8"><a href="data.html#cb75-8"></a><span class="kw">print</span>(A)</span>
<span id="cb75-9"><a href="data.html#cb75-9"></a><span class="co"># choose positive growth rates</span></span>
<span id="cb75-10"><a href="data.html#cb75-10"></a>r &lt;-<span class="st"> </span><span class="kw">runif</span>(n) <span class="op">+</span><span class="st"> </span><span class="fl">0.5</span></span>
<span id="cb75-11"><a href="data.html#cb75-11"></a><span class="kw">print</span>(r)</span></code></pre></div>
<pre><code>#            [,1]       [,2]       [,3]       [,4]        [,5]
# [1,] -1.5822551 -0.6043941 -0.5120159 -0.8297087 -0.22820188
# [2,] -0.8075164 -1.5388470 -0.5050239 -0.1114492 -0.01532989
# [3,] -0.3849424 -0.2946009 -1.9482489 -0.7036884 -0.12898156
# [4,] -0.3277343 -0.5776099 -0.5572494 -2.3117018 -0.09338193
# [5,] -0.6021007 -0.6309793 -0.8679195 -0.2797326 -1.65109857
# [1] 1.291147 1.099732 1.410148 1.060425 1.255705</code></pre>
<p>Now go through all possible combinations:</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="data.html#cb77-1"></a>E &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dv">0</span>, n) <span class="co"># matrix containing all communities</span></span>
<span id="cb77-2"><a href="data.html#cb77-2"></a>x_template &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, n) <span class="co"># template for row of E</span></span>
<span id="cb77-3"><a href="data.html#cb77-3"></a><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>(<span class="dv">2</span><span class="op">^</span>n <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)){</span>
<span id="cb77-4"><a href="data.html#cb77-4"></a>  p &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">intToBits</span>(k)[<span class="dv">1</span><span class="op">:</span>n])</span>
<span id="cb77-5"><a href="data.html#cb77-5"></a>  presence &lt;-<span class="st"> </span>p <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span></span>
<span id="cb77-6"><a href="data.html#cb77-6"></a>  A_k &lt;-<span class="st"> </span>A[presence, presence, drop =<span class="st"> </span><span class="ot">FALSE</span>]</span>
<span id="cb77-7"><a href="data.html#cb77-7"></a>  r_k &lt;-<span class="st"> </span>r[presence]</span>
<span id="cb77-8"><a href="data.html#cb77-8"></a>  <span class="co"># check if equilibrium is feasible</span></span>
<span id="cb77-9"><a href="data.html#cb77-9"></a>  x_k_star &lt;-<span class="st"> </span><span class="kw">solve</span>(A_k, <span class="op">-</span>r_k)</span>
<span id="cb77-10"><a href="data.html#cb77-10"></a>  <span class="cf">if</span> (<span class="kw">all</span>(x_k_star <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>)){</span>
<span id="cb77-11"><a href="data.html#cb77-11"></a>    <span class="co"># check if equilibrium is locally stable</span></span>
<span id="cb77-12"><a href="data.html#cb77-12"></a>    <span class="co"># a) build community matrix</span></span>
<span id="cb77-13"><a href="data.html#cb77-13"></a>    M &lt;-<span class="st"> </span>x_k_star <span class="op">*</span><span class="st"> </span>A_k</span>
<span id="cb77-14"><a href="data.html#cb77-14"></a>    <span class="co"># b) compute eigenvalues</span></span>
<span id="cb77-15"><a href="data.html#cb77-15"></a>    eM &lt;-<span class="st"> </span><span class="kw">eigen</span>(M, <span class="dt">only.values =</span> <span class="ot">TRUE</span>)<span class="op">$</span>values</span>
<span id="cb77-16"><a href="data.html#cb77-16"></a>    <span class="co"># c) check stability</span></span>
<span id="cb77-17"><a href="data.html#cb77-17"></a>    <span class="cf">if</span> (<span class="kw">all</span>(<span class="kw">Re</span>(eM) <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span>)){</span>
<span id="cb77-18"><a href="data.html#cb77-18"></a>      <span class="co"># we have a feasible, stable equilibrium</span></span>
<span id="cb77-19"><a href="data.html#cb77-19"></a>      <span class="co"># add to the set</span></span>
<span id="cb77-20"><a href="data.html#cb77-20"></a>      tmp &lt;-<span class="st"> </span>x_template</span>
<span id="cb77-21"><a href="data.html#cb77-21"></a>      tmp[presence] &lt;-<span class="st"> </span>x_k_star</span>
<span id="cb77-22"><a href="data.html#cb77-22"></a>      E &lt;-<span class="st"> </span><span class="kw">rbind</span>(E, tmp)</span>
<span id="cb77-23"><a href="data.html#cb77-23"></a>    }</span>
<span id="cb77-24"><a href="data.html#cb77-24"></a>  }</span>
<span id="cb77-25"><a href="data.html#cb77-25"></a>}</span>
<span id="cb77-26"><a href="data.html#cb77-26"></a><span class="kw">rownames</span>(E) &lt;-<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb77-27"><a href="data.html#cb77-27"></a><span class="kw">head</span>(E) <span class="co"># show the first few communities</span></span>
<span id="cb77-28"><a href="data.html#cb77-28"></a><span class="kw">tail</span>(E) <span class="co"># show the last few communities</span></span></code></pre></div>
<pre><code>#           [,1]      [,2]      [,3] [,4] [,5]
# [1,] 0.8160172 0.0000000 0.0000000    0    0
# [2,] 0.0000000 0.7146465 0.0000000    0    0
# [3,] 0.6791728 0.3582477 0.0000000    0    0
# [4,] 0.0000000 0.0000000 0.7238026    0    0
# [5,] 0.6215352 0.0000000 0.6009974    0    0
# [6,] 0.0000000 0.5020196 0.6478907    0    0
#            [,1]      [,2]      [,3]      [,4]      [,5]
# [26,] 0.0000000 0.6907495 0.0000000 0.2679023 0.4511633
# [27,] 0.4476631 0.4567147 0.0000000 0.2658808 0.3776961
# [28,] 0.0000000 0.0000000 0.5887242 0.3006418 0.4001216
# [29,] 0.4749396 0.0000000 0.5198836 0.2551261 0.2708252
# [30,] 0.0000000 0.5139182 0.5636548 0.1848845 0.2365139
# [31,] 0.4000232 0.3200119 0.5151320 0.1902248 0.1893434</code></pre>
</div>
<div id="total-biomass" class="section level2">
<h2><span class="header-section-number">5.2</span> Total biomass</h2>
<p>Our simulated communties have much in common with BEF experiments. For example, plotting the species richness on the x-axis and the total biomass on the y-axis, we recover the typical pattern found in real experiments (<span class="citation">(Hector et al. <a href="#ref-hector1999plant" role="doc-biblioref">1999</a>)</span> <span class="citation">(Tilman et al. <a href="#ref-tilman2001diversity" role="doc-biblioref">2001</a>)</span> <span class="citation">(Cadotte <a href="#ref-cadotte2013experimental" role="doc-biblioref">2013</a>)</span>):</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="data.html#cb79-1"></a><span class="kw">library</span>(tidyverse) <span class="co"># plotting and wrangling</span></span>
<span id="cb79-2"><a href="data.html#cb79-2"></a>total_biomass &lt;-<span class="st"> </span><span class="kw">rowSums</span>(E)</span>
<span id="cb79-3"><a href="data.html#cb79-3"></a>species_richness &lt;-<span class="st"> </span><span class="kw">rowSums</span>(E <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>)</span>
<span id="cb79-4"><a href="data.html#cb79-4"></a>BEF &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">species_richness =</span> species_richness, <span class="dt">total_biomass =</span> total_biomass)</span>
<span id="cb79-5"><a href="data.html#cb79-5"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> BEF) <span class="op">+</span><span class="st"> </span></span>
<span id="cb79-6"><a href="data.html#cb79-6"></a><span class="st">  </span><span class="kw">aes</span>(<span class="dt">x =</span> species_richness, <span class="dt">y =</span> total_biomass) <span class="op">+</span><span class="st"> </span></span>
<span id="cb79-7"><a href="data.html#cb79-7"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_smooth</span>()</span></code></pre></div>
<p><img src="A-Tour-of-the-Generalized-Lotka-Volterra-Model_files/figure-html/glvbefplot-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>showing a modest increase in total biomass with increasing species richness.</p>
</div>
<div id="hyperplanes" class="section level2">
<h2><span class="header-section-number">5.3</span> Hyperplanes</h2>
<p>We can rewrite the GLV model as:</p>
<p><span class="math display">\[
\begin{aligned}
\dfrac{dx(t)}{dt} &amp;= D(x(t))(r + A x(t))\\
&amp;= D(r x(t))(1 + B x(t))
\end{aligned}
\]</span>
where we have <span class="math inline">\(b_{ij} = a_{ij} / r_i\)</span>. The equilibrium for each subset of species <span class="math inline">\(k\)</span> (if it exists) can be found as <span class="math inline">\((B^{(k)})^{-1} 1^{(k)}\)</span>, where <span class="math inline">\((B^{(k)})^{-1}\)</span> is the inverse of the <span class="math inline">\(B^{(k)}\)</span> sub-matrix of <span class="math inline">\(B\)</span> in which only the rows/columns belonging to <span class="math inline">\(k\)</span> are retained, and <span class="math inline">\(1^{(k)}\)</span> is a vector of ones with length equal to the number of species in <span class="math inline">\(k\)</span>.</p>
<p>We now want to link the matrix <span class="math inline">\(B\)</span> with the results of the experiments, stored in matrix <span class="math inline">\(E\)</span>. Call <span class="math inline">\(x^{(k)}_i\)</span> the recorded density of taxon <span class="math inline">\(i\)</span> in community <span class="math inline">\(k\)</span> (i.e., stored in one of the rows of <span class="math inline">\(E\)</span>). Then, we can build a matrix <span class="math inline">\(P\)</span> where each row represents an equation <span class="math inline">\(\sum_j b_{ij} x_j^{(k)} = 1\)</span> and we have a column for each coefficient in <span class="math inline">\(B\)</span>. For example, take three taxa, and suppose that we can culture each in isolation, and that the all assemblages coexist when co-cultured. We can write 12 equations: monocultures (<span class="math inline">\(k \in \{1, 2, 4\}\)</span>) give rise to a single equation; co-cultures of two taxa to two equations each (<span class="math inline">\(k \in \{3, 5, 6 \}\)</span>); and communities with three taxa to three independent equations (<span class="math inline">\(k = 7\)</span>). Here are the 12 equations we can write:</p>
<p><span class="math display">\[
\begin{aligned}
b_{11} x_1^{(1)} &amp;= 1\\
b_{22} x_2^{(2)} &amp;= 1\\
b_{11} x_1^{(3)} + b_{12}x_2^{(3)} &amp;= 1\\
b_{21} x_1^{(3)} + b_{22}x_2^{(3)} &amp;= 1\\
b_{33} x_3^{(4)} &amp;= 1\\
b_{11} x_1^{(5)} + b_{13} x_3^{(5)} &amp;= 1\\
b_{31} x_1^{(5)} + b_{33} x_3^{(5)} &amp;= 1\\
b_{22} x_2^{(6)} + b_{23} x_3^{(6)} &amp;= 1\\
b_{32} x_2^{(6)} + b_{33} x_3^{(6)} &amp;= 1\\
b_{11} x_1^{(7)} + b_{12} x_2^{(7)} + b_{13} x_3^{(7)} &amp; = 1\\
b_{21} x_1^{(7)} + b_{22} x_2^{(7)} + b_{23} x_3^{(7)} &amp; = 1\\
b_{31} x_1^{(7)} + b_{32} x_2^{(7)} + b_{33} x_3^{(7)} &amp; = 1
\end{aligned}
\]</span></p>
<p>We can summarize the equations in a more compact form as <span class="math inline">\(P v(B)=1\)</span>:</p>
<p><span class="math display">\[
\begin{pmatrix}
x_1^{(1)} &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; x_2^{(2)} &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
x_1^{(3)} &amp; x_2^{(3)} &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; x_1^{(3)} &amp; x_2^{(3)} &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; x_3^{(4)} \\
x_1^{(5)} &amp; 0 &amp; x_3^{(5)} &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; x_1^{(5)} &amp; 0 &amp; x_3^{(5)} \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; x_2^{(6)} &amp; x_3^{(6)} &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; x_2^{(6)} &amp; x_3^{(6)}\\
x_1^{(7)} &amp; x_2^{(7)} &amp; x_3^{(7)} &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; x_1^{(7)} &amp; x_2^{(7)} &amp; x_3^{(7)} &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; x_1^{(7)} &amp; x_2^{(7)} &amp; x_3^{(7)} 
\end{pmatrix}
\begin{pmatrix}
b_{11}\\
b_{12}\\
b_{13}\\
b_{21}\\
b_{22}\\
b_{23}\\
b_{31}\\
b_{32}\\
b_{33}
\end{pmatrix} 
= 
\begin{pmatrix}
1\\
1\\
1\\
1\\
1\\
1\\
1\\
1\\
1\\
1\\
1\\
1
\end{pmatrix}
\]</span>
where <span class="math inline">\(v(B)\)</span> is a vectorized version of <span class="math inline">\(B\)</span>. Because we have <span class="math inline">\(n 2^{n-1} = 12\)</span> equations, and <span class="math inline">\(n^2 = 9\)</span> variables, in principle the system can be solved. One can recognize the equation above as a linear regression, and choose <span class="math inline">\(\hat{v}(B) = P^{+}1\)</span> (where <span class="math inline">\(P^{+}\)</span> is the Moore-Penrose pseudo-inverse of <span class="math inline">\(P\)</span>). Before doing that, however, we can try to simplify the calculation by rearranging the rows of <span class="math inline">\(P\)</span>:</p>
<p><span class="math display">\[
\begin{pmatrix}
x_1^{(1)} &amp; 0 &amp; 0      &amp; 0 &amp; 0 &amp; 0     &amp; 0 &amp; 0 &amp; 0 \\
x_1^{(3)} &amp; x_2^{(3)} &amp; 0      &amp; 0 &amp; 0 &amp; 0     &amp; 0 &amp; 0 &amp; 0 \\
x_1^{(5)} &amp; 0 &amp; x_3^{(5)}       &amp; 0 &amp; 0 &amp; 0     &amp; 0 &amp; 0 &amp; 0 \\
x_1^{(7)} &amp; x_2^{(7)} &amp; x_3^{(7)} &amp; 0 &amp; 0 &amp; 0     &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0     &amp; 0 &amp; x_2^{(2)} &amp; 0     &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0     &amp; x_1^{(3)} &amp; x_2^{(3)} &amp; 0     &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0     &amp; 0 &amp; x_2^{(6)} &amp; x_3^{(6)}     &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0     &amp; x_1^{(7)} &amp; x_2^{(7)} &amp; x_3^{(7)} &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0      &amp; 0 &amp; 0 &amp; 0     &amp; 0 &amp; 0 &amp; x_3^{(4)} \\
0 &amp; 0 &amp; 0     &amp; 0 &amp; 0 &amp; 0     &amp; x_1^{(5)} &amp; 0 &amp; x_3^{(5)} \\
0 &amp; 0 &amp; 0     &amp; 0 &amp; 0 &amp; 0        &amp; 0 &amp; x_2^{(6)} &amp; x_3^{(6)}\\
0 &amp; 0 &amp; 0     &amp; 0 &amp; 0 &amp; 0        &amp; x_1^{(7)} &amp; x_2^{(7)} &amp; x_3^{(7)} 
\end{pmatrix} 
\begin{pmatrix}
b_{11}\\
b_{12}\\
b_{13}\\
b_{21}\\
b_{22}\\
b_{23}\\
b_{31}\\
b_{32}\\
b_{33}
\end{pmatrix} 
= 
\begin{pmatrix}
1\\
1\\
1\\
1\\
1\\
1\\
1\\
1\\
1\\
1\\
1\\
1
\end{pmatrix}
\]</span></p>
<p>Showing that the matrix <span class="math inline">\(P\)</span> is block-diagonal, with blocks <span class="math inline">\(P_i = E_i\)</span>, where <span class="math inline">\(E_i\)</span> is the matrix <span class="math inline">\(E\)</span> in which only the rows in which species <span class="math inline">\(i\)</span> is present are retained. As such, we can solve for the matrix <span class="math inline">\(B\)</span> one row at a time:</p>
<p><span class="math display">\[
\begin{pmatrix}
x_1^{(1)} &amp; 0 &amp; 0 \\
x_1^{(3)} &amp; x_2^{(3)} &amp; 0 \\
x_1^{(5)} &amp; 0 &amp; x_3^{(5)} \\
x_1^{(7)} &amp; x_2^{(7)} &amp; x_3^{(7)} 
\end{pmatrix} 
\begin{pmatrix}
b_{11}\\
b_{12}\\
b_{13}
\end{pmatrix} 
= 
\begin{pmatrix}
1\\
1\\
1\\
1
\end{pmatrix}
\]</span></p>
<p>For example:</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="data.html#cb80-1"></a><span class="co"># rescaled matrix</span></span>
<span id="cb80-2"><a href="data.html#cb80-2"></a>B &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">/</span><span class="st"> </span>r <span class="op">*</span><span class="st"> </span>A</span>
<span id="cb80-3"><a href="data.html#cb80-3"></a><span class="co"># now try to recover B from matrix E</span></span>
<span id="cb80-4"><a href="data.html#cb80-4"></a>fitted_B &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, n, n)</span>
<span id="cb80-5"><a href="data.html#cb80-5"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</span>
<span id="cb80-6"><a href="data.html#cb80-6"></a>  <span class="co"># take the matrix Ei</span></span>
<span id="cb80-7"><a href="data.html#cb80-7"></a>  Ei &lt;-<span class="st"> </span>E[E[,i] <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>, , drop =<span class="st"> </span><span class="ot">FALSE</span>]</span>
<span id="cb80-8"><a href="data.html#cb80-8"></a>  <span class="co"># solve for the row (MASS::ginv computes the pseudoinverse)</span></span>
<span id="cb80-9"><a href="data.html#cb80-9"></a>  fitted_B[i,] &lt;-<span class="st"> </span><span class="op">-</span><span class="kw">rowSums</span>(MASS<span class="op">::</span><span class="kw">ginv</span>(Ei))</span>
<span id="cb80-10"><a href="data.html#cb80-10"></a>}</span>
<span id="cb80-11"><a href="data.html#cb80-11"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> <span class="kw">tibble</span>(<span class="dt">real =</span> <span class="kw">as.vector</span>(B),</span>
<span id="cb80-12"><a href="data.html#cb80-12"></a>                     <span class="dt">fitted =</span> <span class="kw">as.vector</span>(fitted_B))) <span class="op">+</span><span class="st"> </span></span>
<span id="cb80-13"><a href="data.html#cb80-13"></a><span class="st">  </span><span class="kw">aes</span>(<span class="dt">x =</span> real, <span class="dt">y =</span> fitted) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb80-14"><a href="data.html#cb80-14"></a><span class="st">  </span><span class="kw">geom_abline</span>(<span class="dt">slope =</span> <span class="dv">1</span>, <span class="dt">intercept =</span> <span class="dv">0</span>)</span></code></pre></div>
<p><img src="A-Tour-of-the-Generalized-Lotka-Volterra-Model_files/figure-html/examplefitendpoints-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Notice that in general the system of equations is over-determined. As such, we can fit using a subset of the experiments, and then predict the rest of the experiments out-of-fit. For example, let’s fit again using the information on monocultures and pairs only, and then predict experiment 31, in which all species should coexist:</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="data.html#cb81-1"></a>E_partial &lt;-<span class="st"> </span>E[<span class="kw">rowSums</span>(E<span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) <span class="op">&lt;</span><span class="st"> </span><span class="dv">3</span>, ]</span>
<span id="cb81-2"><a href="data.html#cb81-2"></a>fitted_B &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, n, n)</span>
<span id="cb81-3"><a href="data.html#cb81-3"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</span>
<span id="cb81-4"><a href="data.html#cb81-4"></a>  <span class="co"># take the matrix Ei</span></span>
<span id="cb81-5"><a href="data.html#cb81-5"></a>  Ei &lt;-<span class="st"> </span>E_partial[E_partial[,i] <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>, , drop =<span class="st"> </span><span class="ot">FALSE</span>]</span>
<span id="cb81-6"><a href="data.html#cb81-6"></a>  <span class="co"># solve for the row</span></span>
<span id="cb81-7"><a href="data.html#cb81-7"></a>  fitted_B[i,] &lt;-<span class="st"> </span><span class="op">-</span><span class="kw">rowSums</span>(MASS<span class="op">::</span><span class="kw">ginv</span>(Ei))</span>
<span id="cb81-8"><a href="data.html#cb81-8"></a>}</span>
<span id="cb81-9"><a href="data.html#cb81-9"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> <span class="kw">tibble</span>(<span class="dt">real =</span> <span class="kw">as.vector</span>(B),</span>
<span id="cb81-10"><a href="data.html#cb81-10"></a>                     <span class="dt">fitted =</span> <span class="kw">as.vector</span>(fitted_B))) <span class="op">+</span><span class="st"> </span></span>
<span id="cb81-11"><a href="data.html#cb81-11"></a><span class="st">  </span><span class="kw">aes</span>(<span class="dt">x =</span> real, <span class="dt">y =</span> fitted) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb81-12"><a href="data.html#cb81-12"></a><span class="st">  </span><span class="kw">geom_abline</span>(<span class="dt">slope =</span> <span class="dv">1</span>, <span class="dt">intercept =</span> <span class="dv">0</span>)</span></code></pre></div>
<p><img src="A-Tour-of-the-Generalized-Lotka-Volterra-Model_files/figure-html/examplefitendpoints2-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="data.html#cb82-1"></a><span class="kw">print</span>(<span class="st">&quot;predicted&quot;</span>)</span>
<span id="cb82-2"><a href="data.html#cb82-2"></a><span class="kw">solve</span>(fitted_B, <span class="op">-</span><span class="st"> </span><span class="kw">rep</span>(<span class="dv">1</span>, n))</span>
<span id="cb82-3"><a href="data.html#cb82-3"></a><span class="kw">print</span>(<span class="st">&quot;observed&quot;</span>)</span>
<span id="cb82-4"><a href="data.html#cb82-4"></a>E[(<span class="dv">2</span><span class="op">^</span>n <span class="dv">-1</span>), ]</span></code></pre></div>
<pre><code># [1] &quot;predicted&quot;
# [1] 0.4000232 0.3200119 0.5151320 0.1902248 0.1893434
# [1] &quot;observed&quot;
# [1] 0.4000232 0.3200119 0.5151320 0.1902248 0.1893434</code></pre>
<p>The equation <span class="math inline">\(E_i B_i = -1\)</span> shows that all the equilibria of species <span class="math inline">\(i\)</span> in a GLV system are arranged on a hyperplane.</p>
</div>
<div id="fitting-real-data" class="section level2">
<h2><span class="header-section-number">5.4</span> Fitting real data</h2>
<p>Having played with synthetic data, we can start thinking about data stemming from real experiments. In particular, consider the linear, additive model:</p>
<p><span class="math display">\[
x_i^{(k)} = \gamma_i - \sum_{j\neq i} \theta_{ij} x_i^{(k)}
\]</span>
where <span class="math inline">\(x_i^{(k)}\)</span> is the density of species <span class="math inline">\(i\)</span> in community <span class="math inline">\(k\)</span>, <span class="math inline">\(\gamma_i\)</span> models the density of <span class="math inline">\(i\)</span> when grown in isolation, and the parameters <span class="math inline">\(\theta_{ij}\)</span> how the density of <span class="math inline">\(i\)</span> is influenced by the other species in community <span class="math inline">\(k\)</span>. Dividing both sides by <span class="math inline">\(\gamma_i\)</span> and rearranging:</p>
<p><span class="math display">\[
\sum_{j\neq i} (\theta_{ij} /\gamma_i) x_i^{(k)} + (1/{\gamma_i}) x_i^{(k)}= \sum_j b_{ij} x_j^{(k)} = 1
\]</span>
which is exactly the same system of equations found above. As such, fitting a linear, addittive model for the biomass of each species in each plot is equivalent to finding the equilibrium strcuture of a GLV model that approximates the data.</p>
<p>One thing to consider when modeling real data, contrary to simulated data, is the structure of the errors. For example, empirical data often contain replicates that reach slightly different densities. Moreover, what is typically done in these types of experiments is to sort and measure biomass for a section of each plot, and then to multiply to extrapolate the biomass for the whole plot. As such, if the error is normally distributed for the sub-plot, then it’s going to be lognormally distributed for the whole plot. Furthermore, we need to link the rows of matrix <span class="math inline">\(P\)</span> above, because when we make an error in measuring <span class="math inline">\(x_j^{(k)}\)</span>, the value is reported over several values. Following <span class="citation">Maynard, Miller, and Allesina (<a href="#ref-maynard2019predicting" role="doc-biblioref">2020</a>)</span>, we do the following:</p>
<ul>
<li>Propose a matrix <span class="math inline">\(B\)</span></li>
<li>Compute the predicted abundance for all species in all observed assemblages (call them <span class="math inline">\(\tilde{x}_j^{(k)}\)</span>)</li>
<li>Compute the SSQ: <span class="math inline">\(\sum_{j, k} (\log x_j^{(k)} - \log \tilde{x}_j^{(k)})^2\)</span></li>
<li>Search numerically for the matrix <span class="math inline">\(B\)</span> minimizing the SSQ</li>
</ul>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="data.html#cb84-1"></a><span class="co"># constant to penalize solutions with negative</span></span>
<span id="cb84-2"><a href="data.html#cb84-2"></a><span class="co"># abundances </span></span>
<span id="cb84-3"><a href="data.html#cb84-3"></a>penalization &lt;-<span class="st"> </span><span class="dv">100000</span></span>
<span id="cb84-4"><a href="data.html#cb84-4"></a><span class="co"># main fitting function</span></span>
<span id="cb84-5"><a href="data.html#cb84-5"></a><span class="co"># input: </span></span>
<span id="cb84-6"><a href="data.html#cb84-6"></a><span class="co"># - matrix E as above (the data)</span></span>
<span id="cb84-7"><a href="data.html#cb84-7"></a><span class="co"># - proposed matrix B</span></span>
<span id="cb84-8"><a href="data.html#cb84-8"></a><span class="co"># output:</span></span>
<span id="cb84-9"><a href="data.html#cb84-9"></a><span class="co"># - predicted matrix \tilde{E}</span></span>
<span id="cb84-10"><a href="data.html#cb84-10"></a><span class="co"># - SSQ</span></span>
<span id="cb84-11"><a href="data.html#cb84-11"></a>compute_SSQ &lt;-<span class="st"> </span><span class="cf">function</span>(B, E){</span>
<span id="cb84-12"><a href="data.html#cb84-12"></a>  tildeE &lt;-<span class="st"> </span>E</span>
<span id="cb84-13"><a href="data.html#cb84-13"></a>  ones &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">1</span>, <span class="kw">ncol</span>(B)) <span class="co"># vector of 1s</span></span>
<span id="cb84-14"><a href="data.html#cb84-14"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(E)){</span>
<span id="cb84-15"><a href="data.html#cb84-15"></a>    presence &lt;-<span class="st"> </span>E[i, ] <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span></span>
<span id="cb84-16"><a href="data.html#cb84-16"></a>    <span class="co"># use internal calls to speed up calculation</span></span>
<span id="cb84-17"><a href="data.html#cb84-17"></a>    predicted_x &lt;-<span class="st"> </span><span class="kw">.Internal</span>(<span class="kw">La_solve</span>(B[presence, presence, <span class="dt">drop =</span> <span class="ot">FALSE</span>], </span>
<span id="cb84-18"><a href="data.html#cb84-18"></a>                                      ones[presence], </span>
<span id="cb84-19"><a href="data.html#cb84-19"></a>                                      <span class="dv">10</span><span class="op">^-</span><span class="dv">6</span>))</span>
<span id="cb84-20"><a href="data.html#cb84-20"></a>    tildeE[i, presence] &lt;-<span class="st"> </span>predicted_x</span>
<span id="cb84-21"><a href="data.html#cb84-21"></a>  }</span>
<span id="cb84-22"><a href="data.html#cb84-22"></a>  <span class="co"># now compute SSQ</span></span>
<span id="cb84-23"><a href="data.html#cb84-23"></a>  observed &lt;-<span class="st"> </span>E[E <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>]</span>
<span id="cb84-24"><a href="data.html#cb84-24"></a>  <span class="co"># penalize negatives</span></span>
<span id="cb84-25"><a href="data.html#cb84-25"></a>  predicted &lt;-<span class="st"> </span>tildeE[E <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>]</span>
<span id="cb84-26"><a href="data.html#cb84-26"></a>  predicted[predicted <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span>] &lt;-<span class="st"> </span>penalization</span>
<span id="cb84-27"><a href="data.html#cb84-27"></a>  <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">B =</span> B, </span>
<span id="cb84-28"><a href="data.html#cb84-28"></a>              <span class="dt">E =</span> E, </span>
<span id="cb84-29"><a href="data.html#cb84-29"></a>              <span class="dt">tildeE =</span> tildeE, </span>
<span id="cb84-30"><a href="data.html#cb84-30"></a>              <span class="dt">SSQ =</span> <span class="kw">sum</span>((<span class="kw">log</span>(predicted) <span class="op">-</span><span class="st"> </span><span class="kw">log</span>(observed))<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb84-31"><a href="data.html#cb84-31"></a>              ))</span>
<span id="cb84-32"><a href="data.html#cb84-32"></a>}</span>
<span id="cb84-33"><a href="data.html#cb84-33"></a><span class="co"># for numerical minimization</span></span>
<span id="cb84-34"><a href="data.html#cb84-34"></a>to_minimize &lt;-<span class="st"> </span><span class="cf">function</span>(b, E){</span>
<span id="cb84-35"><a href="data.html#cb84-35"></a>  n &lt;-<span class="st"> </span><span class="kw">ncol</span>(E)</span>
<span id="cb84-36"><a href="data.html#cb84-36"></a>  <span class="kw">return</span>(<span class="kw">compute_SSQ</span>(</span>
<span id="cb84-37"><a href="data.html#cb84-37"></a>    <span class="kw">matrix</span>(b, n, n),</span>
<span id="cb84-38"><a href="data.html#cb84-38"></a>    E</span>
<span id="cb84-39"><a href="data.html#cb84-39"></a>  )<span class="op">$</span>SSQ)</span>
<span id="cb84-40"><a href="data.html#cb84-40"></a>}</span></code></pre></div>
<p>To test this method, we are going to use the data from <span class="citation">Kuebbing et al. (<a href="#ref-kuebbing2015above" role="doc-biblioref">2015</a>)</span>, who co-cultured four species of plant in 14 out of 15 possible combinations. Let’s load the data</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="data.html#cb85-1"></a>url &lt;-<span class="st"> &quot;https://github.com/dsmaynard/endpoints/raw/master/data/Kuebbing_plants/natives.csv&quot;</span></span>
<span id="cb85-2"><a href="data.html#cb85-2"></a>E &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">read_csv</span>(url))</span>
<span id="cb85-3"><a href="data.html#cb85-3"></a><span class="kw">head</span>(E)</span>
<span id="cb85-4"><a href="data.html#cb85-4"></a><span class="kw">tail</span>(E)</span></code></pre></div>
<pre><code>#          as fa la po
# [1,] 1.4711  0  0  0
# [2,] 1.7968  0  0  0
# [3,] 1.8993  0  0  0
# [4,] 2.0634  0  0  0
# [5,] 2.2665  0  0  0
# [6,] 2.3062  0  0  0
#            as     fa     la     po
# [135,] 1.1219 1.8011 0.2390 1.4065
# [136,] 1.4751 1.3486 0.2474 1.5491
# [137,] 0.6021 1.9389 0.1817 2.7487
# [138,] 0.8973 1.6002 0.1156 3.2293
# [139,] 3.0384 1.4442 0.4590 1.5490
# [140,] 2.9240 2.3903 0.2379 4.3230</code></pre>
<p>And let’s try to find a good numerical solution starting from the identity matrix:</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="data.html#cb87-1"></a><span class="kw">set.seed</span>(<span class="dv">2</span>)</span>
<span id="cb87-2"><a href="data.html#cb87-2"></a>B &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dv">4</span>, <span class="dv">4</span>)</span>
<span id="cb87-3"><a href="data.html#cb87-3"></a><span class="kw">diag</span>(B) &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb87-4"><a href="data.html#cb87-4"></a>tmp &lt;-<span class="st"> </span><span class="kw">optim</span>(<span class="dt">par =</span> <span class="kw">as.vector</span>(B), </span>
<span id="cb87-5"><a href="data.html#cb87-5"></a>             <span class="dt">fn =</span> to_minimize, </span>
<span id="cb87-6"><a href="data.html#cb87-6"></a>             <span class="dt">E =</span> E,</span>
<span id="cb87-7"><a href="data.html#cb87-7"></a>             <span class="dt">method =</span> <span class="st">&quot;BFGS&quot;</span>)</span>
<span id="cb87-8"><a href="data.html#cb87-8"></a>best_B &lt;-<span class="st"> </span><span class="kw">matrix</span>(tmp<span class="op">$</span>par, <span class="dv">4</span>, <span class="dv">4</span>)</span>
<span id="cb87-9"><a href="data.html#cb87-9"></a>solution &lt;-<span class="st"> </span><span class="kw">compute_SSQ</span>(best_B, E)</span></code></pre></div>
<p>Now let’s write code to show a nice plot of the predicted vs. observed values for all communities:</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="data.html#cb88-1"></a>plot_solution &lt;-<span class="st"> </span><span class="cf">function</span>(solution){</span>
<span id="cb88-2"><a href="data.html#cb88-2"></a>  <span class="co"># add a column with community composition</span></span>
<span id="cb88-3"><a href="data.html#cb88-3"></a>  spnames &lt;-<span class="st"> </span><span class="kw">colnames</span>(solution<span class="op">$</span>E)</span>
<span id="cb88-4"><a href="data.html#cb88-4"></a>  community &lt;-<span class="st"> </span><span class="kw">apply</span>(solution<span class="op">$</span>E, <span class="dv">1</span>, <span class="cf">function</span>(x) <span class="kw">paste</span>(spnames[x <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>], <span class="dt">collapse =</span> <span class="st">&quot;_&quot;</span>))</span>
<span id="cb88-5"><a href="data.html#cb88-5"></a>  <span class="co"># work with observed data</span></span>
<span id="cb88-6"><a href="data.html#cb88-6"></a>  E &lt;-<span class="st"> </span><span class="kw">as_tibble</span>(solution<span class="op">$</span>E) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb88-7"><a href="data.html#cb88-7"></a><span class="st">    </span><span class="kw">add_column</span>(<span class="dt">community =</span> community) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb88-8"><a href="data.html#cb88-8"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">experiment =</span> <span class="kw">row_number</span>())</span>
<span id="cb88-9"><a href="data.html#cb88-9"></a>  toplot &lt;-<span class="st"> </span>E <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">gather</span>(species, observed_biomass, <span class="op">-</span>experiment, <span class="op">-</span>community) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb88-10"><a href="data.html#cb88-10"></a><span class="st">    </span><span class="kw">filter</span>(observed_biomass <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>)</span>
<span id="cb88-11"><a href="data.html#cb88-11"></a>  <span class="co"># now the predicted data</span></span>
<span id="cb88-12"><a href="data.html#cb88-12"></a>  tildeE &lt;-<span class="st"> </span><span class="kw">as_tibble</span>(solution<span class="op">$</span>tildeE) <span class="op">%&gt;%</span></span>
<span id="cb88-13"><a href="data.html#cb88-13"></a><span class="st">    </span><span class="kw">add_column</span>(<span class="dt">community =</span> community) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb88-14"><a href="data.html#cb88-14"></a><span class="st">    </span><span class="kw">gather</span>(species, predicted_biomass, <span class="op">-</span>community) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb88-15"><a href="data.html#cb88-15"></a><span class="st">    </span><span class="kw">distinct</span>()</span>
<span id="cb88-16"><a href="data.html#cb88-16"></a>  <span class="co"># join the two data sets</span></span>
<span id="cb88-17"><a href="data.html#cb88-17"></a>  toplot &lt;-<span class="st"> </span>toplot <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb88-18"><a href="data.html#cb88-18"></a><span class="st">    </span><span class="kw">inner_join</span>(tildeE, <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;community&quot;</span>, <span class="st">&quot;species&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb88-19"><a href="data.html#cb88-19"></a><span class="st">    </span><span class="kw">filter</span>(observed_biomass <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>)</span>
<span id="cb88-20"><a href="data.html#cb88-20"></a>  pl &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> toplot) <span class="op">+</span><span class="st"> </span></span>
<span id="cb88-21"><a href="data.html#cb88-21"></a><span class="st">    </span><span class="kw">aes</span>(<span class="dt">x =</span> species, <span class="dt">fill =</span> species) <span class="op">+</span><span class="st"> </span></span>
<span id="cb88-22"><a href="data.html#cb88-22"></a><span class="st">    </span><span class="kw">geom_violin</span>(<span class="kw">aes</span>(<span class="dt">y =</span> observed_biomass), <span class="dt">draw_quantiles =</span> <span class="fl">0.5</span>, <span class="dt">scale =</span> <span class="st">&quot;width&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb88-23"><a href="data.html#cb88-23"></a><span class="st">    </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">y =</span> predicted_biomass)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb88-24"><a href="data.html#cb88-24"></a><span class="st">    </span><span class="kw">facet_wrap</span>(<span class="op">~</span>community, <span class="dt">scales =</span> <span class="st">&quot;free_y&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb88-25"><a href="data.html#cb88-25"></a><span class="st">    </span><span class="kw">scale_y_log10</span>(<span class="st">&quot;biomass&quot;</span>)</span>
<span id="cb88-26"><a href="data.html#cb88-26"></a>  <span class="kw">return</span>(pl)</span>
<span id="cb88-27"><a href="data.html#cb88-27"></a>}</span>
<span id="cb88-28"><a href="data.html#cb88-28"></a><span class="kw">plot_solution</span>(solution)</span></code></pre></div>
<p><img src="A-Tour-of-the-Generalized-Lotka-Volterra-Model_files/figure-html/plotendpoints-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="predicting-real-data-out-of-fit" class="section level2">
<h2><span class="header-section-number">5.5</span> Predicting real data out of fit</h2>
<p>Exactly as done for the GLV simulated data, we can attempt fitting the matrix <span class="math inline">\(B\)</span> using only part of the experimental data, and then predict the rest out-of-fit. This is a powerful test to make sure that a) we have chosen a good structure for the statistical model, and b) we are not overfitting. For example, let’s try to predict all triplets out of fit. First, we fit the model using only the information about monocultures, pairs, and the quadruplet (11 experiments); then, we use the fitted matrix to predict all of the data and plot:</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="data.html#cb89-1"></a><span class="kw">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb89-2"><a href="data.html#cb89-2"></a>B &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dv">4</span>, <span class="dv">4</span>)</span>
<span id="cb89-3"><a href="data.html#cb89-3"></a><span class="kw">diag</span>(B) &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb89-4"><a href="data.html#cb89-4"></a>Enotriplets &lt;-<span class="st"> </span>E[<span class="kw">rowSums</span>(E <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) <span class="op">!=</span><span class="st"> </span><span class="dv">3</span>, ]</span>
<span id="cb89-5"><a href="data.html#cb89-5"></a>tmp &lt;-<span class="st"> </span><span class="kw">optim</span>(<span class="dt">par =</span> <span class="kw">as.vector</span>(B), </span>
<span id="cb89-6"><a href="data.html#cb89-6"></a>             <span class="dt">fn =</span> to_minimize, </span>
<span id="cb89-7"><a href="data.html#cb89-7"></a>             <span class="dt">E =</span> Enotriplets,</span>
<span id="cb89-8"><a href="data.html#cb89-8"></a>             <span class="dt">method =</span> <span class="st">&quot;BFGS&quot;</span>)</span>
<span id="cb89-9"><a href="data.html#cb89-9"></a>best_B_oof &lt;-<span class="st"> </span><span class="kw">matrix</span>(tmp<span class="op">$</span>par, <span class="dv">4</span>, <span class="dv">4</span>)</span>
<span id="cb89-10"><a href="data.html#cb89-10"></a>solution_oof &lt;-<span class="st"> </span><span class="kw">compute_SSQ</span>(best_B_oof, E)</span>
<span id="cb89-11"><a href="data.html#cb89-11"></a><span class="kw">plot_solution</span>(solution_oof)</span></code></pre></div>
<p><img src="A-Tour-of-the-Generalized-Lotka-Volterra-Model_files/figure-html/kuebnumerics2-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Repeat excluding all the pairs:</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="data.html#cb90-1"></a><span class="kw">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb90-2"><a href="data.html#cb90-2"></a>B &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dv">4</span>, <span class="dv">4</span>)</span>
<span id="cb90-3"><a href="data.html#cb90-3"></a><span class="kw">diag</span>(B) &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb90-4"><a href="data.html#cb90-4"></a>Enopairs &lt;-<span class="st"> </span>E[<span class="kw">rowSums</span>(E <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) <span class="op">!=</span><span class="st"> </span><span class="dv">2</span>, ]</span>
<span id="cb90-5"><a href="data.html#cb90-5"></a>tmp &lt;-<span class="st"> </span><span class="kw">optim</span>(<span class="dt">par =</span> <span class="kw">as.vector</span>(B), </span>
<span id="cb90-6"><a href="data.html#cb90-6"></a>             <span class="dt">fn =</span> to_minimize, </span>
<span id="cb90-7"><a href="data.html#cb90-7"></a>             <span class="dt">E =</span> Enopairs,</span>
<span id="cb90-8"><a href="data.html#cb90-8"></a>             <span class="dt">method =</span> <span class="st">&quot;BFGS&quot;</span>)</span>
<span id="cb90-9"><a href="data.html#cb90-9"></a>best_B_oof2 &lt;-<span class="st"> </span><span class="kw">matrix</span>(tmp<span class="op">$</span>par, <span class="dv">4</span>, <span class="dv">4</span>)</span>
<span id="cb90-10"><a href="data.html#cb90-10"></a>solution_oof2 &lt;-<span class="st"> </span><span class="kw">compute_SSQ</span>(best_B_oof2, E)</span>
<span id="cb90-11"><a href="data.html#cb90-11"></a><span class="kw">plot_solution</span>(solution_oof2)</span></code></pre></div>
<p><img src="A-Tour-of-the-Generalized-Lotka-Volterra-Model_files/figure-html/kuebnumerics3-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Of course, we might push this too far. For example, a popular way to attempt parameterizing models is to consider only monocultures and pairs:</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="data.html#cb91-1"></a><span class="kw">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb91-2"><a href="data.html#cb91-2"></a>B &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dv">4</span>, <span class="dv">4</span>)</span>
<span id="cb91-3"><a href="data.html#cb91-3"></a><span class="kw">diag</span>(B) &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb91-4"><a href="data.html#cb91-4"></a>Eonlymonopairs &lt;-<span class="st"> </span>E[<span class="kw">rowSums</span>(E <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) <span class="op">&lt;</span><span class="st"> </span><span class="dv">3</span>, ]</span>
<span id="cb91-5"><a href="data.html#cb91-5"></a>tmp &lt;-<span class="st"> </span><span class="kw">optim</span>(<span class="dt">par =</span> <span class="kw">as.vector</span>(B), </span>
<span id="cb91-6"><a href="data.html#cb91-6"></a>             <span class="dt">fn =</span> to_minimize, </span>
<span id="cb91-7"><a href="data.html#cb91-7"></a>             <span class="dt">E =</span> Eonlymonopairs,</span>
<span id="cb91-8"><a href="data.html#cb91-8"></a>             <span class="dt">method =</span> <span class="st">&quot;BFGS&quot;</span>)</span>
<span id="cb91-9"><a href="data.html#cb91-9"></a>best_B_oof3 &lt;-<span class="st"> </span><span class="kw">matrix</span>(tmp<span class="op">$</span>par, <span class="dv">4</span>, <span class="dv">4</span>)</span>
<span id="cb91-10"><a href="data.html#cb91-10"></a>solution_oof3 &lt;-<span class="st"> </span><span class="kw">compute_SSQ</span>(best_B_oof3, E)</span>
<span id="cb91-11"><a href="data.html#cb91-11"></a><span class="kw">plot_solution</span>(solution_oof3)</span></code></pre></div>
<p><img src="A-Tour-of-the-Generalized-Lotka-Volterra-Model_files/figure-html/kuebnumerics4-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>You can see that we predict a lack of coexistence for the system with all four species, while experimentally we have observed coexistence in all ten replicates. <span class="citation">Maynard, Miller, and Allesina (<a href="#ref-maynard2019predicting" role="doc-biblioref">2020</a>)</span> have demonstrated that experimental designs mixing high- and low-abundance experiments provide the best fit while minimizing the number of experiments.</p>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-cadotte2013experimental">
<p>Cadotte, Marc W. 2013. “Experimental Evidence That Evolutionarily Diverse Assemblages Result in Higher Productivity.” <em>Proceedings of the National Academy of Sciences</em> 110 (22): 8996–9000.</p>
</div>
<div id="ref-hector1999plant">
<p>Hector, Aea, B Schmid, C Beierkuhnlein, MC Caldeira, M Diemer, PG Dimitrakopoulos, JA Finn, et al. 1999. “Plant Diversity and Productivity Experiments in European Grasslands.” <em>Science</em> 286 (5442): 1123–7.</p>
</div>
<div id="ref-kuebbing2015above">
<p>Kuebbing, Sara E, Aimée T Classen, Nathan J Sanders, and Daniel Simberloff. 2015. “Above-and Below-Ground Effects of Plant Diversity Depend on Species Origin: An Experimental Test with Multiple Invaders.” <em>New Phytologist</em> 208 (3): 727–35.</p>
</div>
<div id="ref-maynard2019predicting">
<p>Maynard, Daniel S, Zachary R Miller, and Stefano Allesina. 2020. “Predicting Coexistence in Experimental Ecological Communities.” <em>Nature Ecology &amp; Evolution</em> 4: 91–100.</p>
</div>
<div id="ref-tilman2001diversity">
<p>Tilman, David, Peter B Reich, Johannes Knops, David Wedin, Troy Mielke, and Clarence Lehman. 2001. “Diversity and Productivity in a Long-Term Grassland Experiment.” <em>Science</em> 294 (5543): 843–45.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="games.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["A Tour of the Generalized Lotka-Volterra Model.pdf"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
